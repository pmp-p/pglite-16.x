"use strict";var Fi=Object.create;var Et=Object.defineProperty;var Bi=Object.getOwnPropertyDescriptor;var Ii=Object.getOwnPropertyNames;var Ti=Object.getPrototypeOf,Ai=Object.prototype.hasOwnProperty;var nn=r=>{throw TypeError(r)};var L=(r,e)=>()=>(r&&(e=r(r=0)),e);var Z=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),de=(r,e)=>{for(var t in e)Et(r,t,{get:e[t],enumerable:!0})},sn=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Ii(e))!Ai.call(r,i)&&i!==t&&Et(r,i,{get:()=>e[i],enumerable:!(n=Bi(e,i))||n.enumerable});return r};var N=(r,e,t)=>(t=r!=null?Fi(Ti(r)):{},sn(e||!r||!r.__esModule?Et(t,"default",{value:r,enumerable:!0}):t,r)),Pi=r=>sn(Et({},"__esModule",{value:!0}),r);var Vt=(r,e,t)=>e.has(r)||nn("Cannot "+t);var p=(r,e,t)=>(Vt(r,e,"read from private field"),t?t.call(r):e.get(r)),b=(r,e,t)=>e.has(r)?nn("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),x=(r,e,t,n)=>(Vt(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),h=(r,e,t)=>(Vt(r,e,"access private method"),t);var Kt=(r,e,t,n)=>({set _(i){x(r,e,i,t)},get _(){return p(r,e,n)}});var Di,w,m=L(()=>{"use strict";Di=()=>typeof document>"u"?new URL(`file:${__filename}`).href:document.currentScript&&document.currentScript.src||new URL("main.js",document.baseURI).href,w=Di()});var H,We=L(()=>{"use strict";m();H=class{constructor(e){this.dataDir=e}async syncToFs(e,t){}async initialSyncFs(e){}async close(e){}}});var Qe=Z((Na,M)=>{"use strict";m();var un=9007199254740991,cn=function(r){return r}();function Mi(r){return r===cn}function ln(r){return typeof r=="string"||Object.prototype.toString.call(r)=="[object String]"}function Ui(r){return Object.prototype.toString.call(r)=="[object Date]"}function St(r){return r!==null&&typeof r=="object"}function Ft(r){return typeof r=="function"}function Ci(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=un}function ki(r){return Object.prototype.toString.call(r)=="[object Array]"}function pn(r){return St(r)&&!Ft(r)&&Ci(r.length)}function Jt(r){return Object.prototype.toString.call(r)=="[object ArrayBuffer]"}function _i(r,e){return Array.prototype.map.call(r,e)}function vi(r,e){var t=cn;return Ft(e)&&Array.prototype.every.call(r,function(n,i,s){var o=e(n,i,s);return o&&(t=n),!o}),t}function Li(r){return Object.assign.apply(null,arguments)}function fn(r){var e,t,n;if(ln(r)){for(t=r.length,n=new Uint8Array(t),e=0;e<t;e++)n[e]=r.charCodeAt(e)&255;return n}return Jt(r)?new Uint8Array(r):St(r)&&Jt(r.buffer)?new Uint8Array(r.buffer):pn(r)?new Uint8Array(r):St(r)&&Ft(r.toString)?fn(r.toString()):new Uint8Array}M.exports.MAX_SAFE_INTEGER=un;M.exports.isUndefined=Mi;M.exports.isString=ln;M.exports.isObject=St;M.exports.isDateTime=Ui;M.exports.isFunction=Ft;M.exports.isArray=ki;M.exports.isArrayLike=pn;M.exports.isArrayBuffer=Jt;M.exports.map=_i;M.exports.find=vi;M.exports.extend=Li;M.exports.toUint8Array=fn});var Ye=Z((Ma,dn)=>{"use strict";m();var Zt="\0";dn.exports={NULL_CHAR:Zt,TMAGIC:"ustar"+Zt+"00",OLDGNU_MAGIC:"ustar  "+Zt,REGTYPE:0,LNKTYPE:1,SYMTYPE:2,CHRTYPE:3,BLKTYPE:4,DIRTYPE:5,FIFOTYPE:6,CONTTYPE:7,TSUID:parseInt("4000",8),TSGID:parseInt("2000",8),TSVTX:parseInt("1000",8),TUREAD:parseInt("0400",8),TUWRITE:parseInt("0200",8),TUEXEC:parseInt("0100",8),TGREAD:parseInt("0040",8),TGWRITE:parseInt("0020",8),TGEXEC:parseInt("0010",8),TOREAD:parseInt("0004",8),TOWRITE:parseInt("0002",8),TOEXEC:parseInt("0001",8),TPERMALL:parseInt("0777",8),TPERMMASK:parseInt("0777",8)}});var rr=Z((Ca,U)=>{"use strict";m();var hn=Qe(),A=Ye(),zi=512,er=A.TPERMALL,mn=0,yn=0,tr=[["name",100,0,function(r,e){return Ve(r[e[0]],e[1])},function(r,e,t){return he(r.slice(e,e+t[1]))}],["mode",8,100,function(r,e){var t=r[e[0]]||er;return t=t&A.TPERMMASK,De(t,e[1],er)},function(r,e,t){var n=ee(r.slice(e,e+t[1]));return n&=A.TPERMMASK,n}],["uid",8,108,function(r,e){return De(r[e[0]],e[1],mn)},function(r,e,t){return ee(r.slice(e,e+t[1]))}],["gid",8,116,function(r,e){return De(r[e[0]],e[1],yn)},function(r,e,t){return ee(r.slice(e,e+t[1]))}],["size",12,124,function(r,e){return De(r.data.length,e[1])},function(r,e,t){return ee(r.slice(e,e+t[1]))}],["modifyTime",12,136,function(r,e){return Bt(r[e[0]],e[1])},function(r,e,t){return It(r.slice(e,e+t[1]))}],["checksum",8,148,function(r,e){return"        "},function(r,e,t){return ee(r.slice(e,e+t[1]))}],["type",1,156,function(r,e){return""+(parseInt(r[e[0]],10)||0)%8},function(r,e,t){return(parseInt(String.fromCharCode(r[e]),10)||0)%8}],["linkName",100,157,function(r,e){return""},function(r,e,t){return he(r.slice(e,e+t[1]))}],["ustar",8,257,function(r,e){return A.TMAGIC},function(r,e,t){return ji(he(r.slice(e,e+t[1]),!0))},function(r,e){return r[e[0]]==A.TMAGIC||r[e[0]]==A.OLDGNU_MAGIC}],["owner",32,265,function(r,e){return Ve(r[e[0]],e[1])},function(r,e,t){return he(r.slice(e,e+t[1]))}],["group",32,297,function(r,e){return Ve(r[e[0]],e[1])},function(r,e,t){return he(r.slice(e,e+t[1]))}],["majorNumber",8,329,function(r,e){return""},function(r,e,t){return ee(r.slice(e,e+t[1]))}],["minorNumber",8,337,function(r,e){return""},function(r,e,t){return ee(r.slice(e,e+t[1]))}],["prefix",131,345,function(r,e){return Ve(r[e[0]],e[1])},function(r,e,t){return he(r.slice(e,e+t[1]))}],["accessTime",12,476,function(r,e){return Bt(r[e[0]],e[1])},function(r,e,t){return It(r.slice(e,e+t[1]))}],["createTime",12,488,function(r,e){return Bt(r[e[0]],e[1])},function(r,e,t){return It(r.slice(e,e+t[1]))}]],gn=function(r){var e=r[r.length-1];return e[2]+e[1]}(tr);function ji(r){if(r.length==8){var e=r.split("");if(e[5]==A.NULL_CHAR)return(e[6]==" "||e[6]==A.NULL_CHAR)&&(e[6]="0"),(e[7]==" "||e[7]==A.NULL_CHAR)&&(e[7]="0"),e=e.join(""),e==A.TMAGIC?e:r;if(e[7]==A.NULL_CHAR)return e[5]==A.NULL_CHAR&&(e[5]=" "),e[6]==A.NULL_CHAR&&(e[6]=" "),e==A.OLDGNU_MAGIC?e:r}return r}function Ve(r,e){return e-=1,hn.isUndefined(r)&&(r=""),r=(""+r).substr(0,e),r+A.NULL_CHAR}function De(r,e,t){for(t=parseInt(t)||0,e-=1,r=(parseInt(r)||t).toString(8).substr(-e,e);r.length<e;)r="0"+r;return r+A.NULL_CHAR}function Bt(r,e){if(hn.isDateTime(r))r=Math.floor(1*r/1e3);else if(r=parseInt(r,10),isFinite(r)){if(r<=0)return""}else r=Math.floor(1*new Date/1e3);return De(r,e,0)}function he(r,e){var t=String.fromCharCode.apply(null,r);if(e)return t;var n=t.indexOf(A.NULL_CHAR);return n>=0?t.substr(0,n):t}function ee(r){var e=String.fromCharCode.apply(null,r);return parseInt(e.replace(/^0+$/g,""),8)||0}function It(r){return r.length==0||r[0]==0?null:new Date(1e3*ee(r))}function Gi(r,e,t){var n=parseInt(e,10)||0,i=Math.min(n+gn,r.length),s=0,o=0,a=0;t&&tr.every(function(d){return d[0]=="checksum"?(o=n+d[2],a=o+d[1],!1):!0});for(var u=32,c=n;c<i;c++){var f=c>=o&&c<a?u:r[c];s=(s+f)%262144}return s}U.exports.recordSize=zi;U.exports.defaultFileMode=er;U.exports.defaultUid=mn;U.exports.defaultGid=yn;U.exports.posixHeader=tr;U.exports.effectiveHeaderSize=gn;U.exports.calculateChecksum=Gi;U.exports.formatTarString=Ve;U.exports.formatTarNumber=De;U.exports.formatTarDateTime=Bt;U.exports.parseTarString=he;U.exports.parseTarNumber=ee;U.exports.parseTarDateTime=It});var En=Z((_a,xn)=>{"use strict";m();var Hi=Ye(),Tt=Qe(),ie=rr();function wn(r){return ie.recordSize}function bn(r){return Math.ceil(r.data.length/ie.recordSize)*ie.recordSize}function $i(r){var e=0;return r.forEach(function(t){e+=wn(t)+bn(t)}),e+=ie.recordSize*2,new Uint8Array(e)}function qi(r,e,t){t=parseInt(t)||0;var n=t;ie.posixHeader.forEach(function(u){for(var c=u[3](e,u),f=c.length,d=0;d<f;d+=1)r[n+d]=c.charCodeAt(d)&255;n+=u[1]});var i=Tt.find(ie.posixHeader,function(u){return u[0]=="checksum"});if(i){var s=ie.calculateChecksum(r,t,!0),o=ie.formatTarNumber(s,i[1]-2)+Hi.NULL_CHAR+" ";n=t+i[2];for(var a=0;a<o.length;a+=1)r[n]=o.charCodeAt(a)&255,n++}return t+wn(e)}function Wi(r,e,t){return t=parseInt(t,10)||0,r.set(e.data,t),t+bn(e)}function Qi(r){r=Tt.map(r,function(n){return Tt.extend({},n,{data:Tt.toUint8Array(n.data)})});var e=$i(r),t=0;return r.forEach(function(n){t=qi(e,n,t),t=Wi(e,n,t)}),e}xn.exports.tar=Qi});var Fn=Z((La,Sn)=>{"use strict";m();var Yi=Ye(),ir=Qe(),$=rr(),Vi={extractData:!0,checkHeader:!0,checkChecksum:!0,checkFileSize:!0},Ki={size:!0,checksum:!0,ustar:!0},nr={unexpectedEndOfFile:"Unexpected end of file.",fileCorrupted:"File is corrupted.",checksumCheckFailed:"Checksum check failed."};function Xi(r){return $.recordSize}function Ji(r){return Math.ceil(r/$.recordSize)*$.recordSize}function Zi(r,e){for(var t=e,n=Math.min(r.length,e+$.recordSize*2),i=t;i<n;i++)if(r[i]!=0)return!1;return!0}function es(r,e,t){if(r.length-e<$.recordSize){if(t.checkFileSize)throw new Error(nr.unexpectedEndOfFile);return null}e=parseInt(e)||0;var n={},i=e;if($.posixHeader.forEach(function(a){n[a[0]]=a[4](r,i,a),i+=a[1]}),n.type!=0&&(n.size=0),t.checkHeader&&$.posixHeader.forEach(function(a){if(ir.isFunction(a[5])&&!a[5](n,a)){var u=new Error(nr.fileCorrupted);throw u.data={offset:e+a[2],field:a[0]},u}}),t.checkChecksum){var s=$.calculateChecksum(r,e,!0);if(s!=n.checksum){var o=new Error(nr.checksumCheckFailed);throw o.data={offset:e,header:n,checksum:s},o}}return n}function ts(r,e,t,n){return n.extractData?t.size<=0?new Uint8Array:r.slice(e,e+t.size):null}function rs(r,e){var t={};return $.posixHeader.forEach(function(n){var i=n[0];Ki[i]||(t[i]=r[i])}),t.isOldGNUFormat=r.ustar==Yi.OLDGNU_MAGIC,e&&(t.data=e),t}function ns(r,e){e=ir.extend({},Vi,e);for(var t=[],n=0,i=r.length;i-n>=$.recordSize;){r=ir.toUint8Array(r);var s=es(r,n,e);if(!s)break;n+=Xi(s);var o=ts(r,n,s,e);if(t.push(rs(s,o)),n+=Ji(s.size),Zi(r,n))break}return t}Sn.exports.untar=ns});var sr=Z((ja,Bn)=>{"use strict";m();var is=Qe(),ss=Ye(),os=En(),as=Fn();is.extend(Bn.exports,os,as,ss)});async function se(r,e,t="auto"){let n=ls(r,R),[i,s]=await ps(n,t),o=(e||"pgdata")+(s?".tar.gz":".tar"),a=s?"application/x-gzip":"application/x-tar";return typeof File<"u"?new File([i],o,{type:a}):new Blob([i],{type:a})}async function Tn(r,e){let t=new Uint8Array(await e.arrayBuffer()),n=typeof File<"u"&&e instanceof File?e.name:void 0;(us.includes(e.type)||n?.endsWith(".tgz")||n?.endsWith(".tar.gz"))&&(t=await hs(t));let s=(0,q.untar)(t);for(let o of s){let a=R+o.name,u=a.split("/").slice(0,-1);for(let c=1;c<=u.length;c++){let f=u.slice(0,c).join("/");r.analyzePath(f).exists||r.mkdir(f)}o.type===q.REGTYPE?(r.writeFile(a,o.data),r.utime(a,In(o.modifyTime),In(o.modifyTime))):o.type===q.DIRTYPE&&r.mkdir(a)}}function cs(r,e){let t=[],n=i=>{r.readdir(i).forEach(o=>{if(o==="."||o==="..")return;let a=i+"/"+o,u=r.stat(a),c=r.isFile(u.mode)?r.readFile(a,{encoding:"binary"}):new Uint8Array(0);t.push({name:a.substring(e.length),mode:u.mode,size:u.size,type:r.isFile(u.mode)?q.REGTYPE:q.DIRTYPE,modifyTime:u.mtime,data:c}),r.isDir(u.mode)&&n(a)})};return n(e),t}function ls(r,e){let t=cs(r,e);return(0,q.tar)(t)}async function ps(r,e="auto"){if(e==="none")return[r,!1];if(typeof CompressionStream<"u")return[await fs(r),!0];if(typeof process<"u"&&process.versions&&process.versions.node)return[await ds(r),!0];if(e==="auto")return[r,!1];throw new Error("Compression not supported in this environment")}async function fs(r){let e=new CompressionStream("gzip"),t=e.writable.getWriter(),n=e.readable.getReader();t.write(r),t.close();let i=[];for(;;){let{value:a,done:u}=await n.read();if(u)break;a&&i.push(a)}let s=new Uint8Array(i.reduce((a,u)=>a+u.length,0)),o=0;return i.forEach(a=>{s.set(a,o),o+=a.length}),s}async function ds(r){let{promisify:e}=await import("util"),{gzip:t}=await import("zlib");return await e(t)(r)}async function hs(r){if(typeof CompressionStream<"u")return await ms(r);if(typeof process<"u"&&process.versions&&process.versions.node)return await ys(r);throw new Error("Unsupported environment for decompression")}async function ms(r){let e=new DecompressionStream("gzip"),t=e.writable.getWriter(),n=e.readable.getReader();t.write(r),t.close();let i=[];for(;;){let{value:a,done:u}=await n.read();if(u)break;a&&i.push(a)}let s=new Uint8Array(i.reduce((a,u)=>a+u.length,0)),o=0;return i.forEach(a=>{s.set(a,o),o+=a.length}),s}async function ys(r){let{promisify:e}=await import("util"),{gunzip:t}=await import("zlib");return await e(t)(r)}function In(r){return r?typeof r=="number"?r:Math.floor(r.getTime()/1e3):Math.floor(Date.now()/1e3)}var q,us,Oe=L(()=>{"use strict";m();q=N(sr(),1);me();us=["application/x-gtar","application/x-tar+gzip","application/x-gzip","application/gzip"]});var Ne,or=L(()=>{"use strict";m();We();me();Oe();Ne=class extends H{async emscriptenOpts(e){return{...e,preRun:[...e.preRun||[],n=>{let i=n.FS.filesystems.IDBFS;n.FS.mkdir("/pglite"),n.FS.mkdir(`/pglite/${this.dataDir}`),n.FS.mount(i,{},`/pglite/${this.dataDir}`),n.FS.symlink(`/pglite/${this.dataDir}`,R)}]}}initialSyncFs(e){return new Promise((t,n)=>{e.syncfs(!0,i=>{i?n(i):t()})})}syncToFs(e,t){return new Promise((n,i)=>{e.syncfs(!1,s=>{s?i(s):n()})})}async dumpTar(e,t,n){return se(e,t,n)}async close(e){let t=e.filesystems.IDBFS.dbs[this.dataDir];t&&t.close(),e.quit()}}});var Re,ar=L(()=>{"use strict";m();We();Oe();Re=class extends H{async emscriptenOpts(e){return e}async dumpTar(e,t,n){return se(e,t,n)}async close(e){e.quit()}}});var An={};de(An,{NodeFS:()=>ur});var At,Pt,ur,Pn=L(()=>{"use strict";m();At=N(require("fs"),1),Pt=N(require("path"),1);We();me();Oe();ur=class extends H{constructor(e){super(e),this.rootDir=Pt.resolve(e),At.existsSync(Pt.join(this.rootDir))||At.mkdirSync(this.rootDir)}async emscriptenOpts(e){return{...e,preRun:[...e.preRun||[],n=>{let i=n.FS.filesystems.NODEFS;n.FS.mkdir(R),n.FS.mount(i,{root:this.rootDir},R)}]}}async dumpTar(e,t,n){return se(e,t,n)}async close(e){e.quit()}}});var Dt,S,cr=L(()=>{"use strict";m();Dt={EBADF:8,EBADFD:127,EEXIST:20,EINVAL:28,EISDIR:31,ENODEV:43,ENOENT:44,ENOTDIR:54,ENOTEMPTY:55},S=class extends Error{constructor(e,t){super(t),typeof e=="number"?this.code=e:typeof e=="string"&&(this.code=Dt[e])}}});function F(...r){}var Dn,On=L(()=>{"use strict";m();cr();Dn=(r,e)=>{let t=r.FS,n={tryFSOperation(i){try{return i()}catch(s){throw s.code?s.code==="UNKNOWN"?new t.ErrnoError(Dt.EINVAL):new t.ErrnoError(s.code):s}},mount(i){return n.createNode(null,"/",16895,0)},syncfs(i,s,o){},createNode(i,s,o,a){if(!t.isDir(o)&&!t.isFile(o))throw new t.ErrnoError(28);let u=t.createNode(i,s,o);return u.node_ops=n.node_ops,u.stream_ops=n.stream_ops,u},getMode:function(i){return F("getMode",i),n.tryFSOperation(()=>e.lstat(i).mode)},realPath:function(i){let s=[];for(;i.parent!==i;)s.push(i.name),i=i.parent;return s.push(i.mount.opts.root),s.reverse(),s.join("/")},node_ops:{getattr(i){F("getattr",n.realPath(i));let s=n.realPath(i);return n.tryFSOperation(()=>{let o=e.lstat(s);return{...o,dev:0,ino:i.id,nlink:1,rdev:i.rdev,atime:new Date(o.atime),mtime:new Date(o.mtime),ctime:new Date(o.ctime)}})},setattr(i,s){F("setattr",n.realPath(i),s);let o=n.realPath(i);n.tryFSOperation(()=>{s.mode!==void 0&&e.chmod(o,s.mode),s.size!==void 0&&e.truncate(o,s.size),s.timestamp!==void 0&&e.utimes(o,s.timestamp,s.timestamp),s.size!==void 0&&e.truncate(o,s.size)})},lookup(i,s){F("lookup",n.realPath(i),s);let o=[n.realPath(i),s].join("/"),a=n.getMode(o);return n.createNode(i,s,a)},mknod(i,s,o,a){F("mknod",n.realPath(i),s,o,a);let u=n.createNode(i,s,o,a),c=n.realPath(u);return n.tryFSOperation(()=>(t.isDir(u.mode)?e.mkdir(c,{mode:o}):e.writeFile(c,"",{mode:o}),u))},rename(i,s,o){F("rename",n.realPath(i),n.realPath(s),o);let a=n.realPath(i),u=[n.realPath(s),o].join("/");n.tryFSOperation(()=>{e.rename(a,u)}),i.name=o},unlink(i,s){F("unlink",n.realPath(i),s);let o=[n.realPath(i),s].join("/");try{e.unlink(o)}catch{}},rmdir(i,s){F("rmdir",n.realPath(i),s);let o=[n.realPath(i),s].join("/");return n.tryFSOperation(()=>{e.rmdir(o)})},readdir(i){F("readdir",n.realPath(i));let s=n.realPath(i);return n.tryFSOperation(()=>e.readdir(s))},symlink(i,s,o){throw F("symlink",n.realPath(i),s,o),new t.ErrnoError(63)},readlink(i){throw F("readlink",n.realPath(i)),new t.ErrnoError(63)}},stream_ops:{open(i){F("open stream",n.realPath(i.node));let s=n.realPath(i.node);return n.tryFSOperation(()=>{t.isFile(i.node.mode)&&(i.shared.refcount=1,i.nfd=e.open(s))})},close(i){return F("close stream",n.realPath(i.node)),n.tryFSOperation(()=>{t.isFile(i.node.mode)&&i.nfd&&--i.shared.refcount===0&&e.close(i.nfd)})},dup(i){F("dup stream",n.realPath(i.node)),i.shared.refcount++},read(i,s,o,a,u){return F("read stream",n.realPath(i.node),o,a,u),a===0?0:n.tryFSOperation(()=>e.read(i.nfd,s,o,a,u))},write(i,s,o,a,u){return F("write stream",n.realPath(i.node),o,a,u),n.tryFSOperation(()=>e.write(i.nfd,s.buffer,o,a,u))},llseek(i,s,o){F("llseek stream",n.realPath(i.node),s,o);let a=s;if(o===1?a+=i.position:o===2&&t.isFile(i.node.mode)&&n.tryFSOperation(()=>{let u=e.fstat(i.nfd);a+=u.size}),a<0)throw new t.ErrnoError(28);return a},mmap(i,s,o,a,u){if(F("mmap stream",n.realPath(i.node),s,o,a,u),!t.isFile(i.node.mode))throw new t.ErrnoError(Dt.ENODEV);let c=r.mmapAlloc(s);return n.stream_ops.read(i,r.HEAP8,c,s,o),{ptr:c,allocated:!0}},msync(i,s,o,a,u){return F("msync stream",n.realPath(i.node),o,a,u),n.stream_ops.write(i,s,0,a,o),0}}};return n}});var gs,ws,lr,Xe,Je,Ue,ge,Ze,P,te,O,et,oe,ae,Q,y,Nn,ye,Me,W,D,Ke,Rn,pr,fr,Ot,Mn=L(()=>{"use strict";m();cr();gs="state.txt",ws="data",lr={DIR:16384,FILE:32768},fr=class fr{constructor({root:e,initialPoolSize:t,maintainedPoolSize:n}){b(this,y);b(this,Xe,!1);b(this,Je);b(this,Ue);b(this,ge);b(this,Ze);b(this,P);b(this,te,new Map);b(this,O,new Map);b(this,et,0);b(this,oe,new Map);b(this,ae,new Map);this.lastCheckpoint=0;this.checkpointInterval=1e3*60;this.poolCounter=0;b(this,Q,new Set);this.root=e,this.initialPoolSize=t||1e3,this.maintainedPoolSize=n||100,this.readyPromise=h(this,y,Nn).call(this)}static async create(e){let t=new fr(e);return await t.readyPromise,t}get ready(){return p(this,Xe)}async maintainPool(e){e=e||this.maintainedPoolSize;let t=e-this.state.pool.length,n=[];for(let i=0;i<t;i++)n.push(new Promise(async s=>{++this.poolCounter;let o=`${(Date.now()-1704063600).toString(16).padStart(8,"0")}-${this.poolCounter.toString(16).padStart(8,"0")}`,a=await p(this,ge).getFileHandle(o,{create:!0}),u=await a.createSyncAccessHandle();p(this,te).set(o,a),p(this,O).set(o,u),h(this,y,Me).call(this,{opp:"createPoolFile",args:[o]}),this.state.pool.push(o),s()}));for(let i=0;i>t;i--)n.push(new Promise(async s=>{let o=this.state.pool.pop();h(this,y,Me).call(this,{opp:"deletePoolFile",args:[o]});let a=p(this,te).get(o);p(this,O).get(o)?.close(),await a.remove().then(()=>{p(this,te).delete(o),p(this,O).delete(o),s()})}));await Promise.all(n)}_createPoolFileState(e){this.state.pool.push(e)}_deletePoolFileState(e){let t=this.state.pool.indexOf(e);t>-1&&this.state.pool.splice(t,1)}async maybeCheckpointState(){Date.now()-this.lastCheckpoint>this.checkpointInterval&&await this.checkpointState()}async checkpointState(){let e=new TextEncoder().encode(JSON.stringify(this.state));p(this,P).truncate(0),p(this,P).write(e,{at:0}),p(this,P).flush(),this.lastCheckpoint=Date.now()}flush(){for(let e of p(this,Q))try{e.flush()}catch{}p(this,Q).clear()}exit(){for(let e of p(this,O).values())e.close();p(this,P).flush(),p(this,P).close()}chmod(e,t){h(this,y,ye).call(this,{opp:"chmod",args:[e,t]},()=>{this._chmodState(e,t)})}_chmodState(e,t){let n=h(this,y,D).call(this,e);n.mode=t}close(e){let t=h(this,y,Ke).call(this,e);p(this,oe).delete(e),p(this,ae).delete(t)}fstat(e){let t=h(this,y,Ke).call(this,e);return this.lstat(t)}lstat(e){let t=h(this,y,D).call(this,e),n=t.type==="file"?p(this,O).get(t.backingFilename).getSize():0,i=4096;return{dev:0,ino:0,mode:t.mode,nlink:1,uid:0,gid:0,rdev:0,size:n,blksize:i,blocks:Math.ceil(n/i),atime:t.lastModified,mtime:t.lastModified,ctime:t.lastModified}}mkdir(e,t){h(this,y,ye).call(this,{opp:"mkdir",args:[e,t]},()=>{this._mkdirState(e,t)})}_mkdirState(e,t){let n=h(this,y,W).call(this,e),i=n.pop(),s=[],o=this.state.root;for(let u of n){if(s.push(e),!Object.prototype.hasOwnProperty.call(o.children,u))if(t?.recursive)this.mkdir(s.join("/"));else throw new S("ENOENT","No such file or directory");if(o.children[u].type!=="directory")throw new S("ENOTDIR","Not a directory");o=o.children[u]}if(Object.prototype.hasOwnProperty.call(o.children,i))throw new S("EEXIST","File exists");let a={type:"directory",lastModified:Date.now(),mode:t?.mode||lr.DIR,children:{}};o.children[i]=a}open(e,t,n){if(h(this,y,D).call(this,e).type!=="file")throw new S("EISDIR","Is a directory");let s=h(this,y,Rn).call(this);return p(this,oe).set(s,e),p(this,ae).set(e,s),s}readdir(e){let t=h(this,y,D).call(this,e);if(t.type!=="directory")throw new S("ENOTDIR","Not a directory");return Object.keys(t.children)}read(e,t,n,i,s){let o=h(this,y,Ke).call(this,e),a=h(this,y,D).call(this,o);if(a.type!=="file")throw new S("EISDIR","Is a directory");return p(this,O).get(a.backingFilename).read(new Int8Array(t.buffer,n,i),{at:s})}rename(e,t){h(this,y,ye).call(this,{opp:"rename",args:[e,t]},()=>{this._renameState(e,t,!0)})}_renameState(e,t,n=!1){let i=h(this,y,W).call(this,e),s=i.pop(),o=h(this,y,D).call(this,i.join("/"));if(!Object.prototype.hasOwnProperty.call(o.children,s))throw new S("ENOENT","No such file or directory");let a=h(this,y,W).call(this,t),u=a.pop(),c=h(this,y,D).call(this,a.join("/"));if(n&&Object.prototype.hasOwnProperty.call(c.children,u)){let f=c.children[u];p(this,O).get(f.backingFilename).truncate(0),this.state.pool.push(f.backingFilename)}c.children[u]=o.children[s],delete o.children[s]}rmdir(e){h(this,y,ye).call(this,{opp:"rmdir",args:[e]},()=>{this._rmdirState(e)})}_rmdirState(e){let t=h(this,y,W).call(this,e),n=t.pop(),i=h(this,y,D).call(this,t.join("/"));if(!Object.prototype.hasOwnProperty.call(i.children,n))throw new S("ENOENT","No such file or directory");let s=i.children[n];if(s.type!=="directory")throw new S("ENOTDIR","Not a directory");if(Object.keys(s.children).length>0)throw new S("ENOTEMPTY","Directory not empty");delete i.children[n]}truncate(e,t=0){let n=h(this,y,D).call(this,e);if(n.type!=="file")throw new S("EISDIR","Is a directory");let i=p(this,O).get(n.backingFilename);if(!i)throw new S("ENOENT","No such file or directory");i.truncate(t),p(this,Q).add(i)}unlink(e){h(this,y,ye).call(this,{opp:"unlink",args:[e]},()=>{this._unlinkState(e,!0)})}_unlinkState(e,t=!1){let n=h(this,y,W).call(this,e),i=n.pop(),s=h(this,y,D).call(this,n.join("/"));if(!Object.prototype.hasOwnProperty.call(s.children,i))throw new S("ENOENT","No such file or directory");let o=s.children[i];if(o.type!=="file")throw new S("EISDIR","Is a directory");if(delete s.children[i],t){let a=p(this,O).get(o.backingFilename);a?.truncate(0),p(this,Q).add(a),p(this,ae).has(e)&&(p(this,oe).delete(p(this,ae).get(e)),p(this,ae).delete(e))}this.state.pool.push(o.backingFilename)}utimes(e,t,n){h(this,y,ye).call(this,{opp:"utimes",args:[e,t,n]},()=>{this._utimesState(e,t,n)})}_utimesState(e,t,n){let i=h(this,y,D).call(this,e);i.lastModified=n}writeFile(e,t,n){let i=h(this,y,W).call(this,e),s=i.pop(),o=h(this,y,D).call(this,i.join("/"));if(Object.prototype.hasOwnProperty.call(o.children,s)){let c=o.children[s];c.lastModified=Date.now(),h(this,y,Me).call(this,{opp:"setLastModified",args:[e,c.lastModified]})}else{if(this.state.pool.length===0)throw new Error("No more file handles available in the pool");let c={type:"file",lastModified:Date.now(),mode:n?.mode||lr.FILE,backingFilename:this.state.pool.pop()};o.children[s]=c,h(this,y,Me).call(this,{opp:"createFileNode",args:[e,c]})}let a=o.children[s],u=p(this,O).get(a.backingFilename);t.length>0&&(u.write(typeof t=="string"?new TextEncoder().encode(t):new Int8Array(t),{at:0}),e.startsWith("/pg_wal")&&p(this,Q).add(u))}_createFileNodeState(e,t){let n=h(this,y,W).call(this,e),i=n.pop(),s=h(this,y,D).call(this,n.join("/"));s.children[i]=t;let o=this.state.pool.indexOf(t.backingFilename);return o>-1&&this.state.pool.splice(o,1),t}_setLastModifiedState(e,t){let n=h(this,y,D).call(this,e);n.lastModified=t}write(e,t,n,i,s){let o=h(this,y,Ke).call(this,e),a=h(this,y,D).call(this,o);if(a.type!=="file")throw new S("EISDIR","Is a directory");let u=p(this,O).get(a.backingFilename);if(!u)throw new S("EBADF","Bad file descriptor");let c=u.write(new Int8Array(t,n,i),{at:s});return o.startsWith("/pg_wal")&&p(this,Q).add(u),c}};Xe=new WeakMap,Je=new WeakMap,Ue=new WeakMap,ge=new WeakMap,Ze=new WeakMap,P=new WeakMap,te=new WeakMap,O=new WeakMap,et=new WeakMap,oe=new WeakMap,ae=new WeakMap,Q=new WeakMap,y=new WeakSet,Nn=async function(){x(this,Je,await navigator.storage.getDirectory()),x(this,Ue,await h(this,y,pr).call(this,this.root,{create:!0})),x(this,ge,await h(this,y,pr).call(this,ws,{from:p(this,Ue),create:!0})),x(this,Ze,await p(this,Ue).getFileHandle(gs,{create:!0})),x(this,P,await p(this,Ze).createSyncAccessHandle());let e=new ArrayBuffer(p(this,P).getSize());p(this,P).read(e,{at:0});let t,n=new TextDecoder().decode(e).split(`
`),i=!1;try{t=JSON.parse(n[0])}catch{t={root:{type:"directory",lastModified:Date.now(),mode:lr.DIR,children:{}},pool:[]},p(this,P).truncate(0),p(this,P).write(new TextEncoder().encode(JSON.stringify(t)),{at:0}),i=!0}this.state=t;let s=n.slice(1).filter(Boolean).map(c=>JSON.parse(c));for(let c of s){let f=`_${c.opp}State`;if(typeof this[f]=="function")try{this[f].bind(this)(...c.args)}catch(d){console.warn("Error applying OPFS AHP WAL entry",c,d)}}let o=[],a=async c=>{if(c.type==="file")try{let f=await p(this,ge).getFileHandle(c.backingFilename),d=await f.createSyncAccessHandle();p(this,te).set(c.backingFilename,f),p(this,O).set(c.backingFilename,d)}catch(f){console.error("Error opening file handle for node",c,f)}else for(let f of Object.values(c.children))o.push(a(f))};await a(this.state.root);let u=[];for(let c of this.state.pool)u.push(new Promise(async f=>{p(this,te).has(c)&&console.warn("File handle already exists for pool file",c);let d=await p(this,ge).getFileHandle(c),B=await d.createSyncAccessHandle();p(this,te).set(c,d),p(this,O).set(c,B),f()}));await Promise.all([...o,...u]),await this.maintainPool(i?this.initialPoolSize:this.maintainedPoolSize),x(this,Xe,!0)},ye=function(e,t){let n=h(this,y,Me).call(this,e);try{t()}catch(i){throw p(this,P).truncate(n),i}},Me=function(e){let t=JSON.stringify(e),n=new TextEncoder().encode(`
${t}`),i=p(this,P).getSize();return p(this,P).write(n,{at:i}),p(this,Q).add(p(this,P)),i},W=function(e){return e.split("/").filter(Boolean)},D=function(e,t){let n=h(this,y,W).call(this,e),i=t||this.state.root;for(let s of n){if(i.type!=="directory")throw new S("ENOTDIR","Not a directory");if(!Object.prototype.hasOwnProperty.call(i.children,s))throw new S("ENOENT","No such file or directory");i=i.children[s]}return i},Ke=function(e){let t=p(this,oe).get(e);if(!t)throw new S("EBADF","Bad file descriptor");return t},Rn=function(){let e=++Kt(this,et)._;for(;p(this,oe).has(e);)Kt(this,et)._++;return e},pr=async function(e,t){let n=h(this,y,W).call(this,e),i=t?.from||p(this,Je);for(let s of n)i=await i.getDirectoryHandle(s,{create:t?.create});return i};Ot=fr});var Un={};de(Un,{OpfsAhpFS:()=>dr});var tt,rt,dr,Cn=L(()=>{"use strict";m();We();me();On();Mn();Oe();dr=class extends H{constructor(t,{initialPoolSize:n,maintainedPoolSize:i}={}){super(t);b(this,tt);b(this,rt);x(this,tt,n??1e3),x(this,rt,i??100)}async emscriptenOpts(t){return this.opfsAhp=await Ot.create({root:this.dataDir,initialPoolSize:p(this,tt),maintainedPoolSize:p(this,rt)}),{...t,preRun:[...t.preRun||[],i=>{let s=Dn(i,this.opfsAhp);i.FS.mkdir(R),i.FS.mount(s,{},R)}]}}async syncToFs(t,n=!1){await this.opfsAhp?.maybeCheckpointState(),await this.opfsAhp?.maintainPool(),n||this.opfsAhp?.flush()}async dumpTar(t,n,i){return se(t,n,i)}async close(t){this.opfsAhp?.exit(),t.quit()}};tt=new WeakMap,rt=new WeakMap});function kn(r){let e;if(r?.startsWith("file://")){if(r=r.slice(7),!r)throw new Error("Invalid dataDir, must be a valid path");e="nodefs"}else r?.startsWith("idb://")?(r=r.slice(6),e="idbfs"):r?.startsWith("opfs-ahp://")?(r=r.slice(11),e="opfs-ahp"):!r||r?.startsWith("memory://")?e="memoryfs":e="nodefs";return{dataDir:r,fsType:e}}async function _n(r,e){let t;if(r&&e==="nodefs"){let{NodeFS:n}=await Promise.resolve().then(()=>(Pn(),An));t=new n(r)}else if(r&&e==="idbfs")t=new Ne(r);else if(r&&e==="opfs-ahp"){let{OpfsAhpFS:n}=await Promise.resolve().then(()=>(Cn(),Un));t=new n(r)}else t=new Re;return t}var Nt,R,me=L(()=>{"use strict";m();or();ar();Nt="/tmp/pglite",R=Nt+"/base"});var Hn=Z(Rt=>{"use strict";m();Rt.byteLength=xs;Rt.toByteArray=Ss;Rt.fromByteArray=Is;var K=[],_=[],bs=typeof Uint8Array<"u"?Uint8Array:Array,Br="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(xe=0,jn=Br.length;xe<jn;++xe)K[xe]=Br[xe],_[Br.charCodeAt(xe)]=xe;var xe,jn;_[45]=62;_[95]=63;function Gn(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var n=t===e?0:4-t%4;return[t,n]}function xs(r){var e=Gn(r),t=e[0],n=e[1];return(t+n)*3/4-n}function Es(r,e,t){return(e+t)*3/4-t}function Ss(r){var e,t=Gn(r),n=t[0],i=t[1],s=new bs(Es(r,n,i)),o=0,a=i>0?n-4:n,u;for(u=0;u<a;u+=4)e=_[r.charCodeAt(u)]<<18|_[r.charCodeAt(u+1)]<<12|_[r.charCodeAt(u+2)]<<6|_[r.charCodeAt(u+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return i===2&&(e=_[r.charCodeAt(u)]<<2|_[r.charCodeAt(u+1)]>>4,s[o++]=e&255),i===1&&(e=_[r.charCodeAt(u)]<<10|_[r.charCodeAt(u+1)]<<4|_[r.charCodeAt(u+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function Fs(r){return K[r>>18&63]+K[r>>12&63]+K[r>>6&63]+K[r&63]}function Bs(r,e,t){for(var n,i=[],s=e;s<t;s+=3)n=(r[s]<<16&16711680)+(r[s+1]<<8&65280)+(r[s+2]&255),i.push(Fs(n));return i.join("")}function Is(r){for(var e,t=r.length,n=t%3,i=[],s=16383,o=0,a=t-n;o<a;o+=s)i.push(Bs(r,o,o+s>a?a:o+s));return n===1?(e=r[t-1],i.push(K[e>>2]+K[e<<4&63]+"==")):n===2&&(e=(r[t-2]<<8)+r[t-1],i.push(K[e>>10]+K[e>>4&63]+K[e<<2&63]+"=")),i.join("")}});var $n=Z(Ir=>{"use strict";m();Ir.read=function(r,e,t,n,i){var s,o,a=i*8-n-1,u=(1<<a)-1,c=u>>1,f=-7,d=t?i-1:0,B=t?-1:1,I=r[e+d];for(d+=B,s=I&(1<<-f)-1,I>>=-f,f+=a;f>0;s=s*256+r[e+d],d+=B,f-=8);for(o=s&(1<<-f)-1,s>>=-f,f+=n;f>0;o=o*256+r[e+d],d+=B,f-=8);if(s===0)s=1-c;else{if(s===u)return o?NaN:(I?-1:1)*(1/0);o=o+Math.pow(2,n),s=s-c}return(I?-1:1)*o*Math.pow(2,s-n)};Ir.write=function(r,e,t,n,i,s){var o,a,u,c=s*8-i-1,f=(1<<c)-1,d=f>>1,B=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,I=n?0:s-1,k=n?1:-1,bt=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=f):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),o+d>=1?e+=B/u:e+=B*Math.pow(2,1-d),e*u>=2&&(o++,u/=2),o+d>=f?(a=0,o=f):o+d>=1?(a=(e*u-1)*Math.pow(2,i),o=o+d):(a=e*Math.pow(2,d-1)*Math.pow(2,i),o=0));i>=8;r[t+I]=a&255,I+=k,a/=256,i-=8);for(o=o<<i|a,c+=i;c>0;r[t+I]=o&255,I+=k,o/=256,c-=8);r[t+I-k]|=bt*128}});var ai=Z(ve=>{"use strict";m();var Tr=Hn(),ke=$n(),qn=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;ve.Buffer=l;ve.SlowBuffer=Ns;ve.INSPECT_MAX_BYTES=50;var Mt=2147483647;ve.kMaxLength=Mt;l.TYPED_ARRAY_SUPPORT=Ts();!l.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function Ts(){try{let r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch{return!1}}Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}});Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}});function re(r){if(r>Mt)throw new RangeError('The value "'+r+'" is invalid for option "size"');let e=new Uint8Array(r);return Object.setPrototypeOf(e,l.prototype),e}function l(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Or(r)}return Vn(r,e,t)}l.poolSize=8192;function Vn(r,e,t){if(typeof r=="string")return Ps(r,e);if(ArrayBuffer.isView(r))return Ds(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(X(r,ArrayBuffer)||r&&X(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(X(r,SharedArrayBuffer)||r&&X(r.buffer,SharedArrayBuffer)))return Pr(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let n=r.valueOf&&r.valueOf();if(n!=null&&n!==r)return l.from(n,e,t);let i=Os(r);if(i)return i;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return l.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}l.from=function(r,e,t){return Vn(r,e,t)};Object.setPrototypeOf(l.prototype,Uint8Array.prototype);Object.setPrototypeOf(l,Uint8Array);function Kn(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function As(r,e,t){return Kn(r),r<=0?re(r):e!==void 0?typeof t=="string"?re(r).fill(e,t):re(r).fill(e):re(r)}l.alloc=function(r,e,t){return As(r,e,t)};function Or(r){return Kn(r),re(r<0?0:Nr(r)|0)}l.allocUnsafe=function(r){return Or(r)};l.allocUnsafeSlow=function(r){return Or(r)};function Ps(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!l.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let t=Xn(r,e)|0,n=re(t),i=n.write(r,e);return i!==t&&(n=n.slice(0,i)),n}function Ar(r){let e=r.length<0?0:Nr(r.length)|0,t=re(e);for(let n=0;n<e;n+=1)t[n]=r[n]&255;return t}function Ds(r){if(X(r,Uint8Array)){let e=new Uint8Array(r);return Pr(e.buffer,e.byteOffset,e.byteLength)}return Ar(r)}function Pr(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let n;return e===void 0&&t===void 0?n=new Uint8Array(r):t===void 0?n=new Uint8Array(r,e):n=new Uint8Array(r,e,t),Object.setPrototypeOf(n,l.prototype),n}function Os(r){if(l.isBuffer(r)){let e=Nr(r.length)|0,t=re(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||Mr(r.length)?re(0):Ar(r);if(r.type==="Buffer"&&Array.isArray(r.data))return Ar(r.data)}function Nr(r){if(r>=Mt)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Mt.toString(16)+" bytes");return r|0}function Ns(r){return+r!=r&&(r=0),l.alloc(+r)}l.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==l.prototype};l.compare=function(e,t){if(X(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),X(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,i=t.length;for(let s=0,o=Math.min(n,i);s<o;++s)if(e[s]!==t[s]){n=e[s],i=t[s];break}return n<i?-1:i<n?1:0};l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return l.alloc(0);let n;if(t===void 0)for(t=0,n=0;n<e.length;++n)t+=e[n].length;let i=l.allocUnsafe(t),s=0;for(n=0;n<e.length;++n){let o=e[n];if(X(o,Uint8Array))s+o.length>i.length?(l.isBuffer(o)||(o=l.from(o)),o.copy(i,s)):Uint8Array.prototype.set.call(i,o,s);else if(l.isBuffer(o))o.copy(i,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=o.length}return i};function Xn(r,e){if(l.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||X(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);let t=r.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&t===0)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return Dr(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return oi(r).length;default:if(i)return n?-1:Dr(r).length;e=(""+e).toLowerCase(),i=!0}}l.byteLength=Xn;function Rs(r,e,t){let n=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return Gs(this,e,t);case"utf8":case"utf-8":return Zn(this,e,t);case"ascii":return zs(this,e,t);case"latin1":case"binary":return js(this,e,t);case"base64":return vs(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Hs(this,e,t);default:if(n)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),n=!0}}l.prototype._isBuffer=!0;function Ee(r,e,t){let n=r[e];r[e]=r[t],r[t]=n}l.prototype.swap16=function(){let e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)Ee(this,t,t+1);return this};l.prototype.swap32=function(){let e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)Ee(this,t,t+3),Ee(this,t+1,t+2);return this};l.prototype.swap64=function(){let e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)Ee(this,t,t+7),Ee(this,t+1,t+6),Ee(this,t+2,t+5),Ee(this,t+3,t+4);return this};l.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?Zn(this,0,e):Rs.apply(this,arguments)};l.prototype.toLocaleString=l.prototype.toString;l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:l.compare(this,e)===0};l.prototype.inspect=function(){let e="",t=ve.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"};qn&&(l.prototype[qn]=l.prototype.inspect);l.prototype.compare=function(e,t,n,i,s){if(X(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),n===void 0&&(n=e?e.length:0),i===void 0&&(i=0),s===void 0&&(s=this.length),t<0||n>e.length||i<0||s>this.length)throw new RangeError("out of range index");if(i>=s&&t>=n)return 0;if(i>=s)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,i>>>=0,s>>>=0,this===e)return 0;let o=s-i,a=n-t,u=Math.min(o,a),c=this.slice(i,s),f=e.slice(t,n);for(let d=0;d<u;++d)if(c[d]!==f[d]){o=c[d],a=f[d];break}return o<a?-1:a<o?1:0};function Jn(r,e,t,n,i){if(r.length===0)return-1;if(typeof t=="string"?(n=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,Mr(t)&&(t=i?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(i)return-1;t=r.length-1}else if(t<0)if(i)t=0;else return-1;if(typeof e=="string"&&(e=l.from(e,n)),l.isBuffer(e))return e.length===0?-1:Wn(r,e,t,n,i);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):Wn(r,[e],t,n,i);throw new TypeError("val must be string, number or Buffer")}function Wn(r,e,t,n,i){let s=1,o=r.length,a=e.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(r.length<2||e.length<2)return-1;s=2,o/=2,a/=2,t/=2}function u(f,d){return s===1?f[d]:f.readUInt16BE(d*s)}let c;if(i){let f=-1;for(c=t;c<o;c++)if(u(r,c)===u(e,f===-1?0:c-f)){if(f===-1&&(f=c),c-f+1===a)return f*s}else f!==-1&&(c-=c-f),f=-1}else for(t+a>o&&(t=o-a),c=t;c>=0;c--){let f=!0;for(let d=0;d<a;d++)if(u(r,c+d)!==u(e,d)){f=!1;break}if(f)return c}return-1}l.prototype.includes=function(e,t,n){return this.indexOf(e,t,n)!==-1};l.prototype.indexOf=function(e,t,n){return Jn(this,e,t,n,!0)};l.prototype.lastIndexOf=function(e,t,n){return Jn(this,e,t,n,!1)};function Ms(r,e,t,n){t=Number(t)||0;let i=r.length-t;n?(n=Number(n),n>i&&(n=i)):n=i;let s=e.length;n>s/2&&(n=s/2);let o;for(o=0;o<n;++o){let a=parseInt(e.substr(o*2,2),16);if(Mr(a))return o;r[t+o]=a}return o}function Us(r,e,t,n){return Ut(Dr(e,r.length-t),r,t,n)}function Cs(r,e,t,n){return Ut(Qs(e),r,t,n)}function ks(r,e,t,n){return Ut(oi(e),r,t,n)}function _s(r,e,t,n){return Ut(Ys(e,r.length-t),r,t,n)}l.prototype.write=function(e,t,n,i){if(t===void 0)i="utf8",n=this.length,t=0;else if(n===void 0&&typeof t=="string")i=t,n=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(n)?(n=n>>>0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let s=this.length-t;if((n===void 0||n>s)&&(n=s),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let o=!1;for(;;)switch(i){case"hex":return Ms(this,e,t,n);case"utf8":case"utf-8":return Us(this,e,t,n);case"ascii":case"latin1":case"binary":return Cs(this,e,t,n);case"base64":return ks(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _s(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}};l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function vs(r,e,t){return e===0&&t===r.length?Tr.fromByteArray(r):Tr.fromByteArray(r.slice(e,t))}function Zn(r,e,t){t=Math.min(r.length,t);let n=[],i=e;for(;i<t;){let s=r[i],o=null,a=s>239?4:s>223?3:s>191?2:1;if(i+a<=t){let u,c,f,d;switch(a){case 1:s<128&&(o=s);break;case 2:u=r[i+1],(u&192)===128&&(d=(s&31)<<6|u&63,d>127&&(o=d));break;case 3:u=r[i+1],c=r[i+2],(u&192)===128&&(c&192)===128&&(d=(s&15)<<12|(u&63)<<6|c&63,d>2047&&(d<55296||d>57343)&&(o=d));break;case 4:u=r[i+1],c=r[i+2],f=r[i+3],(u&192)===128&&(c&192)===128&&(f&192)===128&&(d=(s&15)<<18|(u&63)<<12|(c&63)<<6|f&63,d>65535&&d<1114112&&(o=d))}}o===null?(o=65533,a=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|o&1023),n.push(o),i+=a}return Ls(n)}var Qn=4096;function Ls(r){let e=r.length;if(e<=Qn)return String.fromCharCode.apply(String,r);let t="",n=0;for(;n<e;)t+=String.fromCharCode.apply(String,r.slice(n,n+=Qn));return t}function zs(r,e,t){let n="";t=Math.min(r.length,t);for(let i=e;i<t;++i)n+=String.fromCharCode(r[i]&127);return n}function js(r,e,t){let n="";t=Math.min(r.length,t);for(let i=e;i<t;++i)n+=String.fromCharCode(r[i]);return n}function Gs(r,e,t){let n=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>n)&&(t=n);let i="";for(let s=e;s<t;++s)i+=Vs[r[s]];return i}function Hs(r,e,t){let n=r.slice(e,t),i="";for(let s=0;s<n.length-1;s+=2)i+=String.fromCharCode(n[s]+n[s+1]*256);return i}l.prototype.slice=function(e,t){let n=this.length;e=~~e,t=t===void 0?n:~~t,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),t<e&&(t=e);let i=this.subarray(e,t);return Object.setPrototypeOf(i,l.prototype),i};function T(r,e,t){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,n){e=e>>>0,t=t>>>0,n||T(e,t,this.length);let i=this[e],s=1,o=0;for(;++o<t&&(s*=256);)i+=this[e+o]*s;return i};l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,n){e=e>>>0,t=t>>>0,n||T(e,t,this.length);let i=this[e+--t],s=1;for(;t>0&&(s*=256);)i+=this[e+--t]*s;return i};l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e=e>>>0,t||T(e,1,this.length),this[e]};l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||T(e,2,this.length),this[e]|this[e+1]<<8};l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||T(e,2,this.length),this[e]<<8|this[e+1]};l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||T(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||T(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};l.prototype.readBigUInt64LE=le(function(e){e=e>>>0,_e(e,"offset");let t=this[e],n=this[e+7];(t===void 0||n===void 0)&&pt(e,this.length-8);let i=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,s=this[++e]+this[++e]*2**8+this[++e]*2**16+n*2**24;return BigInt(i)+(BigInt(s)<<BigInt(32))});l.prototype.readBigUInt64BE=le(function(e){e=e>>>0,_e(e,"offset");let t=this[e],n=this[e+7];(t===void 0||n===void 0)&&pt(e,this.length-8);let i=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],s=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n;return(BigInt(i)<<BigInt(32))+BigInt(s)});l.prototype.readIntLE=function(e,t,n){e=e>>>0,t=t>>>0,n||T(e,t,this.length);let i=this[e],s=1,o=0;for(;++o<t&&(s*=256);)i+=this[e+o]*s;return s*=128,i>=s&&(i-=Math.pow(2,8*t)),i};l.prototype.readIntBE=function(e,t,n){e=e>>>0,t=t>>>0,n||T(e,t,this.length);let i=t,s=1,o=this[e+--i];for(;i>0&&(s*=256);)o+=this[e+--i]*s;return s*=128,o>=s&&(o-=Math.pow(2,8*t)),o};l.prototype.readInt8=function(e,t){return e=e>>>0,t||T(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};l.prototype.readInt16LE=function(e,t){e=e>>>0,t||T(e,2,this.length);let n=this[e]|this[e+1]<<8;return n&32768?n|4294901760:n};l.prototype.readInt16BE=function(e,t){e=e>>>0,t||T(e,2,this.length);let n=this[e+1]|this[e]<<8;return n&32768?n|4294901760:n};l.prototype.readInt32LE=function(e,t){return e=e>>>0,t||T(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};l.prototype.readInt32BE=function(e,t){return e=e>>>0,t||T(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};l.prototype.readBigInt64LE=le(function(e){e=e>>>0,_e(e,"offset");let t=this[e],n=this[e+7];(t===void 0||n===void 0)&&pt(e,this.length-8);let i=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});l.prototype.readBigInt64BE=le(function(e){e=e>>>0,_e(e,"offset");let t=this[e],n=this[e+7];(t===void 0||n===void 0)&&pt(e,this.length-8);let i=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(i)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n)});l.prototype.readFloatLE=function(e,t){return e=e>>>0,t||T(e,4,this.length),ke.read(this,e,!0,23,4)};l.prototype.readFloatBE=function(e,t){return e=e>>>0,t||T(e,4,this.length),ke.read(this,e,!1,23,4)};l.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||T(e,8,this.length),ke.read(this,e,!0,52,8)};l.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||T(e,8,this.length),ke.read(this,e,!1,52,8)};function C(r,e,t,n,i,s){if(!l.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(t+n>r.length)throw new RangeError("Index out of range")}l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,n,i){if(e=+e,t=t>>>0,n=n>>>0,!i){let a=Math.pow(2,8*n)-1;C(this,e,t,n,a,0)}let s=1,o=0;for(this[t]=e&255;++o<n&&(s*=256);)this[t+o]=e/s&255;return t+n};l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,n,i){if(e=+e,t=t>>>0,n=n>>>0,!i){let a=Math.pow(2,8*n)-1;C(this,e,t,n,a,0)}let s=n-1,o=1;for(this[t+s]=e&255;--s>=0&&(o*=256);)this[t+s]=e/o&255;return t+n};l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,n){return e=+e,t=t>>>0,n||C(this,e,t,1,255,0),this[t]=e&255,t+1};l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t=t>>>0,n||C(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2};l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t=t>>>0,n||C(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2};l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t=t>>>0,n||C(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4};l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t=t>>>0,n||C(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function ei(r,e,t,n,i){si(e,n,i,r,t,7);let s=Number(e&BigInt(4294967295));r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o,t}function ti(r,e,t,n,i){si(e,n,i,r,t,7);let s=Number(e&BigInt(4294967295));r[t+7]=s,s=s>>8,r[t+6]=s,s=s>>8,r[t+5]=s,s=s>>8,r[t+4]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=o,o=o>>8,r[t+2]=o,o=o>>8,r[t+1]=o,o=o>>8,r[t]=o,t+8}l.prototype.writeBigUInt64LE=le(function(e,t=0){return ei(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});l.prototype.writeBigUInt64BE=le(function(e,t=0){return ti(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});l.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t=t>>>0,!i){let u=Math.pow(2,8*n-1);C(this,e,t,n,u-1,-u)}let s=0,o=1,a=0;for(this[t]=e&255;++s<n&&(o*=256);)e<0&&a===0&&this[t+s-1]!==0&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+n};l.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t=t>>>0,!i){let u=Math.pow(2,8*n-1);C(this,e,t,n,u-1,-u)}let s=n-1,o=1,a=0;for(this[t+s]=e&255;--s>=0&&(o*=256);)e<0&&a===0&&this[t+s+1]!==0&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+n};l.prototype.writeInt8=function(e,t,n){return e=+e,t=t>>>0,n||C(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1};l.prototype.writeInt16LE=function(e,t,n){return e=+e,t=t>>>0,n||C(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2};l.prototype.writeInt16BE=function(e,t,n){return e=+e,t=t>>>0,n||C(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2};l.prototype.writeInt32LE=function(e,t,n){return e=+e,t=t>>>0,n||C(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4};l.prototype.writeInt32BE=function(e,t,n){return e=+e,t=t>>>0,n||C(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};l.prototype.writeBigInt64LE=le(function(e,t=0){return ei(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});l.prototype.writeBigInt64BE=le(function(e,t=0){return ti(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ri(r,e,t,n,i,s){if(t+n>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function ni(r,e,t,n,i){return e=+e,t=t>>>0,i||ri(r,e,t,4,34028234663852886e22,-34028234663852886e22),ke.write(r,e,t,n,23,4),t+4}l.prototype.writeFloatLE=function(e,t,n){return ni(this,e,t,!0,n)};l.prototype.writeFloatBE=function(e,t,n){return ni(this,e,t,!1,n)};function ii(r,e,t,n,i){return e=+e,t=t>>>0,i||ri(r,e,t,8,17976931348623157e292,-17976931348623157e292),ke.write(r,e,t,n,52,8),t+8}l.prototype.writeDoubleLE=function(e,t,n){return ii(this,e,t,!0,n)};l.prototype.writeDoubleBE=function(e,t,n){return ii(this,e,t,!1,n)};l.prototype.copy=function(e,t,n,i){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),!i&&i!==0&&(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);let s=i-n;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,n,i):Uint8Array.prototype.set.call(e,this.subarray(n,i),t),s};l.prototype.fill=function(e,t,n,i){if(typeof e=="string"){if(typeof t=="string"?(i=t,t=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(e.length===1){let o=e.charCodeAt(0);(i==="utf8"&&o<128||i==="latin1")&&(e=o)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t=t>>>0,n=n===void 0?this.length:n>>>0,e||(e=0);let s;if(typeof e=="number")for(s=t;s<n;++s)this[s]=e;else{let o=l.isBuffer(e)?e:l.from(e,i),a=o.length;if(a===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<n-t;++s)this[s+t]=o[s%a]}return this};var Ce={};function Rr(r,e,t){Ce[r]=class extends t{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(i){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:i,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}Rr("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);Rr("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError);Rr("ERR_OUT_OF_RANGE",function(r,e,t){let n=`The value of "${r}" is out of range.`,i=t;return Number.isInteger(t)&&Math.abs(t)>2**32?i=Yn(String(t)):typeof t=="bigint"&&(i=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(i=Yn(i)),i+="n"),n+=` It must be ${e}. Received ${i}`,n},RangeError);function Yn(r){let e="",t=r.length,n=r[0]==="-"?1:0;for(;t>=n+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function $s(r,e,t){_e(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&pt(e,r.length-(t+1))}function si(r,e,t,n,i,s){if(r>t||r<e){let o=typeof e=="bigint"?"n":"",a;throw s>3?e===0||e===BigInt(0)?a=`>= 0${o} and < 2${o} ** ${(s+1)*8}${o}`:a=`>= -(2${o} ** ${(s+1)*8-1}${o}) and < 2 ** ${(s+1)*8-1}${o}`:a=`>= ${e}${o} and <= ${t}${o}`,new Ce.ERR_OUT_OF_RANGE("value",a,r)}$s(n,i,s)}function _e(r,e){if(typeof r!="number")throw new Ce.ERR_INVALID_ARG_TYPE(e,"number",r)}function pt(r,e,t){throw Math.floor(r)!==r?(_e(r,t),new Ce.ERR_OUT_OF_RANGE(t||"offset","an integer",r)):e<0?new Ce.ERR_BUFFER_OUT_OF_BOUNDS:new Ce.ERR_OUT_OF_RANGE(t||"offset",`>= ${t?1:0} and <= ${e}`,r)}var qs=/[^+/0-9A-Za-z-_]/g;function Ws(r){if(r=r.split("=")[0],r=r.trim().replace(qs,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function Dr(r,e){e=e||1/0;let t,n=r.length,i=null,s=[];for(let o=0;o<n;++o){if(t=r.charCodeAt(o),t>55295&&t<57344){if(!i){if(t>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===n){(e-=3)>-1&&s.push(239,191,189);continue}i=t;continue}if(t<56320){(e-=3)>-1&&s.push(239,191,189),i=t;continue}t=(i-55296<<10|t-56320)+65536}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,t<128){if((e-=1)<0)break;s.push(t)}else if(t<2048){if((e-=2)<0)break;s.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;s.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;s.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return s}function Qs(r){let e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function Ys(r,e){let t,n,i,s=[];for(let o=0;o<r.length&&!((e-=2)<0);++o)t=r.charCodeAt(o),n=t>>8,i=t%256,s.push(i),s.push(n);return s}function oi(r){return Tr.toByteArray(Ws(r))}function Ut(r,e,t,n){let i;for(i=0;i<n&&!(i+t>=e.length||i>=r.length);++i)e[i+t]=r[i];return i}function X(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function Mr(r){return r!==r}var Vs=function(){let r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){let n=t*16;for(let i=0;i<16;++i)e[n+i]=r[t]+r[i]}return e}();function le(r){return typeof BigInt>"u"?Ks:r}function Ks(){throw new Error("BigInt not supported")}});var xa={};de(xa,{IdbFs:()=>Ne,MemoryFS:()=>Re,Mutex:()=>ne,PGlite:()=>Xr,formatQuery:()=>zn,messages:()=>Fr,parse:()=>qr,protocol:()=>Kr,types:()=>$r,uuid:()=>Ln});module.exports=Pi(xa);m();m();m();var Fa=new Error("timeout while waiting for mutex to become available"),Ba=new Error("mutex already locked"),Oi=new Error("request for lock canceled"),Ni=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(f){try{c(n.next(f))}catch(d){o(d)}}function u(f){try{c(n.throw(f))}catch(d){o(d)}}function c(f){f.done?s(f.value):i(f.value).then(a,u)}c((n=n.apply(r,e||[])).next())})},Xt=class{constructor(e,t=Oi){this._value=e,this._cancelError=t,this._weightedQueues=[],this._weightedWaiters=[]}acquire(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise((t,n)=>{this._weightedQueues[e-1]||(this._weightedQueues[e-1]=[]),this._weightedQueues[e-1].push({resolve:t,reject:n}),this._dispatch()})}runExclusive(e,t=1){return Ni(this,void 0,void 0,function*(){let[n,i]=yield this.acquire(t);try{return yield e(n)}finally{i()}})}waitForUnlock(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise(t=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),this._weightedWaiters[e-1].push(t),this._dispatch()})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatch()}release(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatch()}cancel(){this._weightedQueues.forEach(e=>e.forEach(t=>t.reject(this._cancelError))),this._weightedQueues=[]}_dispatch(){var e;for(let t=this._value;t>0;t--){let n=(e=this._weightedQueues[t-1])===null||e===void 0?void 0:e.shift();if(!n)continue;let i=this._value,s=t;this._value-=t,t=this._value+1,n.resolve([i,this._newReleaser(s)])}this._drainUnlockWaiters()}_newReleaser(e){let t=!1;return()=>{t||(t=!0,this.release(e))}}_drainUnlockWaiters(){for(let e=this._value;e>0;e--)this._weightedWaiters[e-1]&&(this._weightedWaiters[e-1].forEach(t=>t()),this._weightedWaiters[e-1]=[])}},Ri=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(f){try{c(n.next(f))}catch(d){o(d)}}function u(f){try{c(n.throw(f))}catch(d){o(d)}}function c(f){f.done?s(f.value):i(f.value).then(a,u)}c((n=n.apply(r,e||[])).next())})},ne=class{constructor(e){this._semaphore=new Xt(1,e)}acquire(){return Ri(this,void 0,void 0,function*(){let[,e]=yield this._semaphore.acquire();return e})}runExclusive(e){return this._semaphore.runExclusive(()=>e())}isLocked(){return this._semaphore.isLocked()}waitForUnlock(){return this._semaphore.waitForUnlock()}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}};m();var on=N(require("./postgres.cjs").default,1),an=on.default;me();m();var hr=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";async function vn(){let r=new URL("./postgres.wasm",w),e=new URL("./postgres.data",w),t=n=>n.pathname;return hr&&(t=(await import("url")).fileURLToPath),n=>{let i=null;switch(n){case"postgres.data":i=e;break;case"postgres.wasm":i=r;break;default:console.error("makeLocateFile",n)}return i?.protocol==="file:"?t(i):i?.toString()??""}}var Ln=()=>{if(globalThis.crypto?.randomUUID)return globalThis.crypto.randomUUID();let r=new Uint8Array(16);if(globalThis.crypto?.getRandomValues)globalThis.crypto.getRandomValues(r);else for(let t=0;t<r.length;t++)r[t]=Math.floor(Math.random()*256);r[6]=r[6]&15|64,r[8]=r[8]&63|128;let e=[];return r.forEach(t=>{e.push(t.toString(16).padStart(2,"0"))}),e.slice(0,4).join("")+"-"+e.slice(4,6).join("")+"-"+e.slice(6,8).join("")+"-"+e.slice(8,10).join("")+"-"+e.slice(10).join("")};async function zn(r,e,t){if(!t||t.length===0)return e;let n=e.replace(/\$([0-9]+)/g,(s,o)=>"%"+o+"L");return(await r.query(`SELECT format($1, ${t.map((s,o)=>`$${o+2}`).join(", ")}) as query`,[n,...t],{setAllTypes:!0})).rows[0].query}var qr={};de(qr,{parseResults:()=>$t});m();var Fr={};de(Fr,{AuthenticationMD5Password:()=>ut,BackendKeyDataMessage:()=>ct,CommandCompleteMessage:()=>V,CopyDataMessage:()=>nt,CopyResponse:()=>it,DataRowMessage:()=>ce,DatabaseError:()=>Y,Field:()=>st,NoticeMessage:()=>be,NotificationResponseMessage:()=>we,ParameterDescriptionMessage:()=>ot,ParameterStatusMessage:()=>at,ReadyForQueryMessage:()=>lt,RowDescriptionMessage:()=>ue,bindComplete:()=>yr,closeComplete:()=>gr,copyDone:()=>Sr,emptyQuery:()=>Er,noData:()=>wr,parseComplete:()=>mr,portalSuspended:()=>br,replicationStart:()=>xr});m();var mr={name:"parseComplete",length:5},yr={name:"bindComplete",length:5},gr={name:"closeComplete",length:5},wr={name:"noData",length:5},br={name:"portalSuspended",length:5},xr={name:"replicationStart",length:4},Er={name:"emptyQuery",length:4},Sr={name:"copyDone",length:4},Y=class extends Error{constructor(t,n,i){super(t);this.length=n;this.name=i}},nt=class{constructor(e,t){this.length=e;this.chunk=t;this.name="copyData"}},it=class{constructor(e,t,n,i){this.length=e;this.name=t;this.binary=n;this.columnTypes=new Array(i)}},st=class{constructor(e,t,n,i,s,o,a){this.name=e;this.tableID=t;this.columnID=n;this.dataTypeID=i;this.dataTypeSize=s;this.dataTypeModifier=o;this.format=a}},ue=class{constructor(e,t){this.length=e;this.fieldCount=t;this.name="rowDescription";this.fields=new Array(this.fieldCount)}},ot=class{constructor(e,t){this.length=e;this.parameterCount=t;this.name="parameterDescription";this.dataTypeIDs=new Array(this.parameterCount)}},at=class{constructor(e,t,n){this.length=e;this.parameterName=t;this.parameterValue=n;this.name="parameterStatus"}},ut=class{constructor(e,t){this.length=e;this.salt=t;this.name="authenticationMD5Password"}},ct=class{constructor(e,t,n){this.length=e;this.processID=t;this.secretKey=n;this.name="backendKeyData"}},we=class{constructor(e,t,n,i){this.length=e;this.processId=t;this.channel=n;this.payload=i;this.name="notification"}},lt=class{constructor(e,t){this.length=e;this.status=t;this.name="readyForQuery"}},V=class{constructor(e,t){this.length=e;this.text=t;this.name="commandComplete"}},ce=class{constructor(e,t){this.length=e;this.fields=t;this.name="dataRow";this.fieldCount=t.length}},be=class{constructor(e,t){this.length=e;this.message=t;this.name="notice"}};var $r={};de($r,{ABSTIME:()=>co,ACLITEM:()=>wo,BIT:()=>Fo,BOOL:()=>Ur,BPCHAR:()=>bo,BYTEA:()=>_t,CHAR:()=>ci,CID:()=>ro,CIDR:()=>uo,CIRCLE:()=>fo,DATE:()=>zr,FLOAT4:()=>vr,FLOAT8:()=>zt,GTSVECTOR:()=>Lo,INET:()=>go,INT2:()=>Cr,INT4:()=>kr,INT8:()=>ft,INTERVAL:()=>Eo,JSON:()=>Lt,JSONB:()=>Hr,MACADDR:()=>yo,MACADDR8:()=>ho,MONEY:()=>mo,NUMERIC:()=>Io,OID:()=>_r,PATH:()=>oo,PG_DEPENDENCIES:()=>ko,PG_LSN:()=>Uo,PG_NDISTINCT:()=>Co,PG_NODE_TREE:()=>io,POLYGON:()=>ao,REFCURSOR:()=>To,REGCLASS:()=>Oo,REGCONFIG:()=>zo,REGDICTIONARY:()=>jo,REGNAMESPACE:()=>Go,REGOPER:()=>Po,REGOPERATOR:()=>Do,REGPROC:()=>Zs,REGPROCEDURE:()=>Ao,REGROLE:()=>Ho,REGTYPE:()=>No,RELTIME:()=>lo,SMGR:()=>so,TEXT:()=>vt,TID:()=>eo,TIME:()=>xo,TIMESTAMP:()=>jr,TIMESTAMPTZ:()=>Gr,TIMETZ:()=>So,TINTERVAL:()=>po,TSQUERY:()=>vo,TSVECTOR:()=>_o,TXID_SNAPSHOT:()=>Mo,UUID:()=>Ro,VARBIT:()=>Bo,VARCHAR:()=>Lr,XID:()=>to,XML:()=>no,arrayTypes:()=>Ct,parseArray:()=>mi,parseType:()=>Ht,parsers:()=>pi,serializeType:()=>Gt,serializerFor:()=>di,serializerInstanceof:()=>fi,serializers:()=>kt,types:()=>li});m();m();var ui=N(ai(),1),J;globalThis.Buffer?J=globalThis.Buffer:J=ui.Buffer;var Xs=globalThis.JSON.parse,Js=globalThis.JSON.stringify,Ur=16,_t=17,ci=18,ft=20,Cr=21,kr=23,Zs=24,vt=25,_r=26,eo=27,to=28,ro=29,Lt=114,no=142,io=194,so=210,oo=602,ao=604,uo=650,vr=700,zt=701,co=702,lo=703,po=704,fo=718,ho=774,mo=790,yo=829,go=869,wo=1033,bo=1042,Lr=1043,zr=1082,xo=1083,jr=1114,Gr=1184,Eo=1186,So=1266,Fo=1560,Bo=1562,Io=1700,To=1790,Ao=2202,Po=2203,Do=2204,Oo=2205,No=2206,Ro=2950,Mo=2970,Uo=3220,Co=3361,ko=3402,_o=3614,vo=3615,Lo=3642,zo=3734,jo=3769,Hr=3802,Go=4089,Ho=4096,Ct={1001:_t,1002:ci,1016:ft,1005:Cr,1007:kr,1009:vt,1028:_r,199:Lt,1021:vr,1022:zt,1015:Lr,3807:Hr,1182:zr,1115:jr,1116:Gr},li={string:{to:0,from:[vt,Lr],serialize:r=>r,parse:r=>r,forceTo:vt},number:{to:0,from:[Cr,kr,_r,vr,zt],serialize:r=>r.toString(),parse:r=>+r,forceTo:r=>Number.isInteger(r)?ft:zt},bigint:{to:ft,from:[ft],js:[BigInt],serialize:r=>r.toString(),parse:r=>{let e=BigInt(r);return e<Number.MIN_SAFE_INTEGER||e>Number.MAX_SAFE_INTEGER?e:Number(e)}},json:{to:Lt,from:[Lt,Hr],serialize:r=>Js(r),parse:r=>Xs(r)},boolean:{to:Ur,from:[Ur],serialize:r=>r===!0?"t":"f",parse:r=>r==="t"},date:{to:1184,from:[zr,jr,Gr],js:[Date],serialize:r=>(r instanceof Date?r:new Date(r)).toISOString(),parse:r=>new Date(r)},bytea:{to:_t,from:[_t],js:[Uint8Array,J],serialize:r=>"\\x"+J.from(r).toString("hex"),parse:r=>new Uint8Array(J.from(r.slice(2),"hex"))},array:{to:0,from:Object.keys(Ct).map(r=>+r),serialize:r=>hi(r),parse:(r,e)=>{let t;return e&&e in Ct&&(t=pi[Ct[e]]),mi(r,t)}}},jt=qo(li),pi=jt.parsers,kt=jt.serializers,fi=jt.serializerInstanceof;function di(r){if(Array.isArray(r))return kt.array;let e=kt[typeof r];if(e)return e;for(let[t,n]of fi)if(r instanceof t)return n;return kt.json}function Gt(r,e=!1){return r==null?[null,0]:di(r)(r,e)}function $o(r){return'"'+r.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'}function hi(r){let e="{";for(let t=0;t<r.length;t++)if(t>0&&(e=e+","),r[t]===null||typeof r[t]>"u")e=e+"NULL";else if(Array.isArray(r[t]))e=e+hi(r[t]);else if(ArrayBuffer.isView(r[t])){let n=r[t];if(!(n instanceof J)){let i=J.from(n.buffer,n.byteOffset,n.byteLength);i.length===n.byteLength?n=i:n=i.slice(n.byteOffset,n.byteOffset+n.byteLength)}e+="\\\\x"+n.toString("hex")}else e+=$o(Gt(r[t])[0]);return e=e+"}",e}function mi(r,e){let t=0,n=null,i="",s=!1,o=0,a;function u(c){let f=[];for(;t<c.length;t++){if(n=c[t],s)n==="\\"?i+=c[++t]:n==='"'?(f.push(e?e(i):i),i="",s=c[t+1]==='"',o=t+2):i+=n;else if(n==='"')s=!0;else if(n==="{")o=++t,f.push(u(c));else if(n==="}"){s=!1,o<t&&f.push(e?e(c.slice(o,t)):c.slice(o,t)),o=t+1;break}else n===","&&a!=="}"&&a!=='"'&&(f.push(e?e(c.slice(o,t)):c.slice(o,t)),o=t+1);a=n}return o<t&&f.push(e?e(c.slice(o,t+1)):c.slice(o,t+1)),f}return u(r)[0]}function Ht(r,e,t){if(r===null)return null;let n=t?.[e]??jt.parsers[e];return n?n(r,e):r}function qo(r){return Object.keys(r).reduce(({parsers:e,serializers:t,serializerInstanceof:n},i)=>{let{to:s,from:o,serialize:a,parse:u=null,forceTo:c}=r[i],f=(d,B=!1)=>[a(d),B&&c?typeof c=="function"?c(d):c:s];return t[s]=f,t[i]=f,r[i].js&&r[i].js.forEach(d=>n.push([d,f])),u&&(Array.isArray(o)?o.forEach(d=>e[d]=u):e[o]=u,e[i]=u),{parsers:e,serializers:t,serializerInstanceof:n}},{parsers:{},serializers:{},serializerInstanceof:[]})}function $t(r,e,t){let n=[],i={rows:[],fields:[]},s=0,o=r.filter(a=>a instanceof ue||a instanceof ce||a instanceof V);return o.forEach((a,u)=>{a instanceof ue?i.fields=a.fields.map(c=>({name:c.name,dataTypeID:c.dataTypeID})):a instanceof ce&&i?e?.rowMode==="array"?i.rows.push(a.fields.map((c,f)=>Ht(c,i.fields[f].dataTypeID,e?.parsers))):i.rows.push(Object.fromEntries(a.fields.map((c,f)=>[i.fields[f].name,Ht(c,i.fields[f].dataTypeID,e?.parsers)]))):a instanceof V&&(s+=Wo(a),u===o.length-1?n.push({...i,affectedRows:s,...t?{blob:t}:{}}):n.push(i),i={rows:[],fields:[]})}),n.length===0&&n.push({rows:[],fields:[]}),n}function Wo(r){let e=r.text.split(" ");switch(e[0]){case"INSERT":return parseInt(e[2],10);case"UPDATE":case"DELETE":return parseInt(e[1],10);default:return 0}}m();var yi=N(sr(),1);async function Wr(r){if(hr){let e=await import("fs"),t=await import("zlib"),{Writable:n}=await import("stream"),{pipeline:i}=await import("stream/promises");if(!e.existsSync(r))throw new Error(`Extension bundle not found: ${r}`);let s=t.createGunzip(),o=[];return await i(e.createReadStream(r),s,new n({write(a,u,c){o.push(a),c()}})),new Blob(o)}else{let e=await fetch(r.toString());if(!e.ok||!e.body)return null;if(e.headers.get("Content-Encoding")==="gzip")return e.blob();{let t=new DecompressionStream("gzip");return new Response(e.body.pipeThrough(t)).blob()}}}async function gi(r,e){for(let t in r.pg_extensions){let n;try{n=await r.pg_extensions[t]}catch(i){console.error("Failed to fetch extension:",t,i);continue}if(n){let i=new Uint8Array(await n.arrayBuffer());Qo(r,t,i,e)}else console.error("Could not get binary data for extension:",t)}}function Qo(r,e,t,n){yi.default.untar(t).forEach(s=>{if(!s.name.startsWith(".")){let o=r.WASM_PREFIX+"/"+s.name;if(s.name.endsWith(".so")){let a=(...c)=>{n("pgfs:ext OK",o,c)},u=(...c)=>{n("pgfs:ext FAIL",o,c)};r.FS.createPreloadedFile(Yo(o),s.name.split("/").pop().slice(0,-3),s.data,!0,!0,a,u,!1)}else r.FS.writeFile(o,s.data)}})}function Yo(r){let e=r.lastIndexOf("/");return e>0?r.slice(0,e):r}Oe();me();var Kr={};de(Kr,{DatabaseError:()=>Y,parse:()=>ba,serialize:()=>z});m();m();var v=require("buffer");m();var Le=require("buffer"),ze=class{constructor(e=256){this.size=e;this.offset=5;this.headerPosition=0;this.buffer=Le.Buffer.allocUnsafe(e)}ensure(e){var t=this.buffer.length-this.offset;if(t<e){var n=this.buffer,i=n.length+(n.length>>1)+e;this.buffer=Le.Buffer.allocUnsafe(i),n.copy(this.buffer)}}addInt32(e){return this.ensure(4),this.buffer[this.offset++]=e>>>24&255,this.buffer[this.offset++]=e>>>16&255,this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addInt16(e){return this.ensure(2),this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addCString(e){if(!e)this.ensure(1);else{var t=Le.Buffer.byteLength(e);this.ensure(t+1),this.buffer.write(e,this.offset,"utf-8"),this.offset+=t}return this.buffer[this.offset++]=0,this}addString(e=""){var t=Le.Buffer.byteLength(e);return this.ensure(t),this.buffer.write(e,this.offset),this.offset+=t,this}add(e){return this.ensure(e.length),e.copy(this.buffer,this.offset),this.offset+=e.length,this}join(e){if(e){this.buffer[this.headerPosition]=e;let t=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(t,this.headerPosition+1)}return this.buffer.slice(e?0:5,this.offset)}flush(e){var t=this.join(e);return this.offset=5,this.headerPosition=0,this.buffer=Le.Buffer.allocUnsafe(this.size),t}};var E=new ze,Vo=r=>{E.addInt16(3).addInt16(0);for(let n of Object.keys(r))E.addCString(n).addCString(r[n]);E.addCString("client_encoding").addCString("UTF8");var e=E.addCString("").flush(),t=e.length+4;return new ze().addInt32(t).add(e).flush()},Ko=()=>{let r=v.Buffer.allocUnsafe(8);return r.writeInt32BE(8,0),r.writeInt32BE(80877103,4),r},Xo=r=>E.addCString(r).flush(112),Jo=function(r,e){return E.addCString(r).addInt32(v.Buffer.byteLength(e)).addString(e),E.flush(112)},Zo=function(r){return E.addString(r).flush(112)},ea=r=>E.addCString(r).flush(81),wi=[],ta=r=>{let e=r.name||"";e.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",e,e.length),console.error("This can cause conflicts and silent errors executing queries"));let t=r.types||wi;for(var n=t.length,i=E.addCString(e).addCString(r.text).addInt16(n),s=0;s<n;s++)i.addInt32(t[s]);return E.flush(80)},je=new ze;var ra=function(r,e){for(let t=0;t<r.length;t++){let n=e?e(r[t],t):r[t];n==null?(E.addInt16(0),je.addInt32(-1)):n instanceof v.Buffer?(E.addInt16(1),je.addInt32(n.length),je.add(n)):(E.addInt16(0),je.addInt32(v.Buffer.byteLength(n)),je.addString(n))}},na=(r={})=>{let e=r.portal||"",t=r.statement||"",n=r.binary||!1,i=r.values||wi,s=i.length;return E.addCString(e).addCString(t),E.addInt16(s),ra(i,r.valueMapper),E.addInt16(s),E.add(je.flush()),E.addInt16(n?1:0),E.flush(66)},ia=v.Buffer.from([69,0,0,0,9,0,0,0,0,0]),sa=r=>{if(!r||!r.portal&&!r.rows)return ia;let e=r.portal||"",t=r.rows||0,n=v.Buffer.byteLength(e),i=4+n+1+4,s=v.Buffer.allocUnsafe(1+i);return s[0]=69,s.writeInt32BE(i,1),s.write(e,5,"utf-8"),s[n+5]=0,s.writeUInt32BE(t,s.length-4),s},oa=(r,e)=>{let t=v.Buffer.allocUnsafe(16);return t.writeInt32BE(16,0),t.writeInt16BE(1234,4),t.writeInt16BE(5678,6),t.writeInt32BE(r,8),t.writeInt32BE(e,12),t},Qr=(r,e)=>{let n=4+v.Buffer.byteLength(e)+1,i=v.Buffer.allocUnsafe(1+n);return i[0]=r,i.writeInt32BE(n,1),i.write(e,5,"utf-8"),i[n]=0,i},aa=E.addCString("P").flush(68),ua=E.addCString("S").flush(68),ca=r=>r.name?Qr(68,`${r.type}${r.name||""}`):r.type==="P"?aa:ua,la=r=>{let e=`${r.type}${r.name||""}`;return Qr(67,e)},pa=r=>E.add(r).flush(100),fa=r=>Qr(102,r),qt=r=>v.Buffer.from([r,0,0,0,4]),da=qt(72),ha=qt(83),ma=qt(88),ya=qt(99),z={startup:Vo,password:Xo,requestSsl:Ko,sendSASLInitialResponseMessage:Jo,sendSCRAMClientFinalMessage:Zo,query:ea,parse:ta,bind:na,execute:sa,describe:ca,close:la,flush:()=>da,sync:()=>ha,end:()=>ma,copyData:pa,copyDone:()=>ya,copyFail:fa,cancel:oa};m();var Vr=require("buffer");m();var bi=require("buffer"),ga=bi.Buffer.allocUnsafe(0),Wt=class{constructor(e=0){this.offset=e;this.buffer=ga;this.encoding="utf-8"}setBuffer(e,t){this.offset=e,this.buffer=t}int16(){let e=this.buffer.readInt16BE(this.offset);return this.offset+=2,e}byte(){let e=this.buffer[this.offset];return this.offset++,e}int32(){let e=this.buffer.readInt32BE(this.offset);return this.offset+=4,e}string(e){let t=this.buffer.toString(this.encoding,this.offset,this.offset+e);return this.offset+=e,t}cstring(){let e=this.offset,t=e;for(;this.buffer[t++]!==0;);return this.offset=t,this.buffer.toString(this.encoding,e,t-1)}bytes(e){let t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}};var Yr=1,wa=4,xi=Yr+wa,Ei=Vr.Buffer.allocUnsafe(0);var Se=class{constructor(e){this.buffer=Ei;this.bufferLength=0;this.bufferOffset=0;this.reader=new Wt;if(e?.mode==="binary")throw new Error("Binary mode not supported yet");this.mode=e?.mode||"text"}parse(e,t){this.mergeBuffer(e);let n=this.bufferOffset+this.bufferLength,i=this.bufferOffset;for(;i+xi<=n;){let s=this.buffer[i],o=this.buffer.readUInt32BE(i+Yr),a=Yr+o;if(a+i<=n){let u=this.handlePacket(i+xi,s,o,this.buffer);t(u),i+=a}else break}i===n?(this.buffer=Ei,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=n-i,this.bufferOffset=i)}mergeBuffer(e){if(this.bufferLength>0){let t=this.bufferLength+e.byteLength;if(t+this.bufferOffset>this.buffer.byteLength){let i;if(t<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)i=this.buffer;else{let s=this.buffer.byteLength*2;for(;t>=s;)s*=2;i=Vr.Buffer.allocUnsafe(s)}this.buffer.copy(i,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=i,this.bufferOffset=0}e.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=t}else this.buffer=e,this.bufferOffset=0,this.bufferLength=e.byteLength}handlePacket(e,t,n,i){switch(t){case 50:return yr;case 49:return mr;case 51:return gr;case 110:return wr;case 115:return br;case 99:return Sr;case 87:return xr;case 73:return Er;case 68:return this.parseDataRowMessage(e,n,i);case 67:return this.parseCommandCompleteMessage(e,n,i);case 90:return this.parseReadyForQueryMessage(e,n,i);case 65:return this.parseNotificationMessage(e,n,i);case 82:return this.parseAuthenticationResponse(e,n,i);case 83:return this.parseParameterStatusMessage(e,n,i);case 75:return this.parseBackendKeyData(e,n,i);case 69:return this.parseErrorMessage(e,n,i,"error");case 78:return this.parseErrorMessage(e,n,i,"notice");case 84:return this.parseRowDescriptionMessage(e,n,i);case 116:return this.parseParameterDescriptionMessage(e,n,i);case 71:return this.parseCopyInMessage(e,n,i);case 72:return this.parseCopyOutMessage(e,n,i);case 100:return this.parseCopyData(e,n,i);default:return new Y("received invalid response: "+t.toString(16),n,"error")}}parseReadyForQueryMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.string(1);return new lt(t,i)}parseCommandCompleteMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.cstring();return new V(t,i)}parseCopyData(e,t,n){let i=n.slice(e,e+(t-4));return new nt(t,i)}parseCopyInMessage(e,t,n){return this.parseCopyMessage(e,t,n,"copyInResponse")}parseCopyOutMessage(e,t,n){return this.parseCopyMessage(e,t,n,"copyOutResponse")}parseCopyMessage(e,t,n,i){this.reader.setBuffer(e,n);let s=this.reader.byte()!==0,o=this.reader.int16(),a=new it(t,i,s,o);for(let u=0;u<o;u++)a.columnTypes[u]=this.reader.int16();return a}parseNotificationMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.int32(),s=this.reader.cstring(),o=this.reader.cstring();return new we(t,i,s,o)}parseRowDescriptionMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.int16(),s=new ue(t,i);for(let o=0;o<i;o++)s.fields[o]=this.parseField();return s}parseField(){let e=this.reader.cstring(),t=this.reader.int32(),n=this.reader.int16(),i=this.reader.int32(),s=this.reader.int16(),o=this.reader.int32(),a=this.reader.int16()===0?"text":"binary";return new st(e,t,n,i,s,o,a)}parseParameterDescriptionMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.int16(),s=new ot(t,i);for(let o=0;o<i;o++)s.dataTypeIDs[o]=this.reader.int32();return s}parseDataRowMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.int16(),s=new Array(i);for(let o=0;o<i;o++){let a=this.reader.int32();s[o]=a===-1?null:this.reader.string(a)}return new ce(t,s)}parseParameterStatusMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.cstring(),s=this.reader.cstring();return new at(t,i,s)}parseBackendKeyData(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.int32(),s=this.reader.int32();return new ct(t,i,s)}parseAuthenticationResponse(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.int32(),s={name:"authenticationOk",length:t};switch(i){case 0:break;case 3:s.length===8&&(s.name="authenticationCleartextPassword");break;case 5:if(s.length===12){s.name="authenticationMD5Password";let a=this.reader.bytes(4);return new ut(t,a)}break;case 10:s.name="authenticationSASL",s.mechanisms=[];let o;do o=this.reader.cstring(),o&&s.mechanisms.push(o);while(o);break;case 11:s.name="authenticationSASLContinue",s.data=this.reader.string(t-8);break;case 12:s.name="authenticationSASLFinal",s.data=this.reader.string(t-8);break;default:throw new Error("Unknown authenticationOk message type "+i)}return s}parseErrorMessage(e,t,n,i){this.reader.setBuffer(e,n);let s={},o=this.reader.string(1);for(;o!=="\0";)s[o]=this.reader.cstring(),o=this.reader.string(1);let a=s.M,u=i==="notice"?new be(t,a):new Y(a,t,i);return u.severity=s.S,u.code=s.C,u.detail=s.D,u.hint=s.H,u.position=s.P,u.internalPosition=s.p,u.internalQuery=s.q,u.where=s.W,u.schema=s.s,u.table=s.t,u.column=s.c,u.dataType=s.d,u.constraint=s.n,u.file=s.F,u.line=s.L,u.routine=s.R,u}};function ba(r,e){let t=new Se;return r.on("data",n=>t.parse(n,e)),new Promise(n=>r.on("end",()=>n()))}var Ge,Be,Ie,Te,He,mt,$e,Qt,qe,yt,gt,wt,Ae,j,G,Pe,g,Si,Jr,pe,Zr,en,dt,fe,ht,Fe,tn=class tn{constructor(e={},t={}){b(this,g);b(this,Ge,!1);b(this,Be,!1);b(this,Ie,!1);b(this,Te,!1);b(this,He,!1);b(this,mt,new ne);b(this,$e,new ne);b(this,Qt,new ne);b(this,qe,!1);this.debug=0;b(this,yt);b(this,gt,[]);b(this,wt,new Se);b(this,Ae);b(this,j);b(this,G,new Map);b(this,Pe,new Set);typeof e=="string"?t={dataDir:e,...t}:t=e,this.dataDir=t.dataDir,t?.debug!==void 0&&(this.debug=t.debug),t?.relaxedDurability!==void 0&&x(this,He,t.relaxedDurability),x(this,yt,t.extensions??{}),this.waitReady=h(this,g,Si).call(this,t??{})}static async create(e){let t=new tn(e);return await t.waitReady,t}get Module(){return this.mod}get ready(){return p(this,Ge)&&!p(this,Be)&&!p(this,Ie)}get closed(){return p(this,Ie)}async close(){await h(this,g,dt).call(this),x(this,Be,!0);for(let e of p(this,gt))await e();try{await this.execProtocol(z.end())}catch(e){let t=e;if(!(t.name==="ExitStatus"&&t.status===0))throw e}await this.fs.close(this.mod.FS),x(this,Ie,!0),x(this,Be,!1)}async[Symbol.asyncDispose](){await this.close()}async query(e,t,n){return await h(this,g,dt).call(this),await p(this,$e).runExclusive(async()=>await h(this,g,Jr).call(this,e,t,n))}async exec(e,t){return await h(this,g,dt).call(this),await p(this,$e).runExclusive(async()=>await h(this,g,pe).call(this,e,t))}async transaction(e){return await h(this,g,dt).call(this),await p(this,$e).runExclusive(async()=>{await h(this,g,pe).call(this,"BEGIN");let t=!1,n=()=>{if(t)throw new Error("Transaction is closed")};try{let s=await e({query:async(o,a,u)=>(n(),await h(this,g,Jr).call(this,o,a,u)),exec:async(o,a)=>(n(),await h(this,g,pe).call(this,o,a)),rollback:async()=>{n(),await h(this,g,pe).call(this,"ROLLBACK"),t=!0},get closed(){return t}});return t||(t=!0,await h(this,g,pe).call(this,"COMMIT")),s}catch(i){throw t||await h(this,g,pe).call(this,"ROLLBACK"),i}})}async execProtocolRaw(e,{syncToFs:t=!0}={}){let n=e.length,i=this.mod;i._interactive_write(n),i.HEAPU8.set(e,1),i._interactive_one();let s=n+2,o=s+i._interactive_read(),a=i.HEAPU8.subarray(s,o);return t&&await h(this,g,ht).call(this),a}async execProtocol(e,{syncToFs:t=!0,onNotice:n}={}){let i=await this.execProtocolRaw(e,{syncToFs:t}),s=[];return p(this,wt).parse(J.from(i),o=>{if(o instanceof Y)throw x(this,wt,new Se),o;if(o instanceof be)this.debug>0&&console.warn(o),n&&n(o);else if(o instanceof V)switch(o.text){case"BEGIN":x(this,Te,!0);break;case"COMMIT":case"ROLLBACK":x(this,Te,!1);break}else if(o instanceof we){let a=p(this,G).get(o.channel);a&&a.forEach(u=>{queueMicrotask(()=>u(o.payload))}),p(this,Pe).forEach(u=>{queueMicrotask(()=>u(o.channel,o.payload))})}s.push([o,i])}),s}async listen(e,t){return p(this,G).has(e)||p(this,G).set(e,new Set),p(this,G).get(e).add(t),await this.exec(`LISTEN ${e}`),async()=>{await this.unlisten(e,t)}}async unlisten(e,t){t?(p(this,G).get(e)?.delete(t),p(this,G).get(e)?.size===0&&(await this.exec(`UNLISTEN ${e}`),p(this,G).delete(e))):(await this.exec(`UNLISTEN ${e}`),p(this,G).delete(e))}onNotification(e){return p(this,Pe).add(e),()=>{p(this,Pe).delete(e)}}offNotification(e){p(this,Pe).delete(e)}async dumpDataDir(e){let t=this.dataDir?.split("/").pop()??"pgdata";return this.fs.dumpTar(this.mod.FS,t,e)}};Ge=new WeakMap,Be=new WeakMap,Ie=new WeakMap,Te=new WeakMap,He=new WeakMap,mt=new WeakMap,$e=new WeakMap,Qt=new WeakMap,qe=new WeakMap,yt=new WeakMap,gt=new WeakMap,wt=new WeakMap,Ae=new WeakMap,j=new WeakMap,G=new WeakMap,Pe=new WeakMap,g=new WeakSet,Si=async function(e){if(e.fs)this.fs=e.fs;else{let{dataDir:a,fsType:u}=kn(e.dataDir);this.fs=await _n(a,u)}let t={},n=[],i=[`PGDATA=${R}`,`PREFIX=${Nt}`,`PGUSER=${e.username??"postgres"}`,`PGDATABASE=${e.database??"template1"}`,"MODE=REACT","REPL=N",...this.debug?["-d",this.debug.toString()]:[]],s={WASM_PREFIX:Nt,arguments:i,INITIAL_MEMORY:e.initialMemory,noExitRuntime:!0,...this.debug>0?{print:console.info,printErr:console.error}:{print:()=>{},printErr:()=>{}},locateFile:await vn(),preRun:[a=>{let u=a.FS.makedev(64,0),c={open:f=>{},close:f=>{},read:(f,d,B,I,k)=>{let bt=p(this,Ae);if(!bt)throw new Error("No /dev/blob File or Blob provided to read from");let Yt=new Uint8Array(bt);if(k>=Yt.length)return 0;let rn=Math.min(Yt.length-k,I);for(let xt=0;xt<rn;xt++)d[B+xt]=Yt[k+xt];return rn},write:(f,d,B,I,k)=>(p(this,j)??x(this,j,[]),p(this,j).push(d.slice(B,B+I)),I),llseek:(f,d,B)=>{let I=p(this,Ae);if(!I)throw new Error("No /dev/blob File or Blob provided to llseek");let k=d;if(B===1?k+=f.position:B===2&&(k=new Uint8Array(I).length),k<0)throw new a.FS.ErrnoError(28);return k}};a.FS.registerDevice(u,c),a.FS.mkdev("/dev/blob",u)}]};s=await this.fs.emscriptenOpts(s);for(let[a,u]of Object.entries(p(this,yt)))if(u instanceof URL)t[a]=Wr(u);else{let c=await u.setup(this,s);if(c.emscriptenOpts&&(s=c.emscriptenOpts),c.namespaceObj){let f=this;f[a]=c.namespaceObj}c.bundlePath&&(t[a]=Wr(c.bundlePath)),c.init&&n.push(c.init),c.close&&p(this,gt).push(c.close)}if(s.pg_extensions=t,this.mod=await an(s),await this.fs.initialSyncFs(this.mod.FS),e.loadDataDir){if(this.mod.FS.analyzePath(R+"/PG_VERSION").exists)throw new Error("Database already exists, cannot load from tarball");h(this,g,Fe).call(this,"pglite: loading data from tarball"),await Tn(this.mod.FS,e.loadDataDir)}this.mod.FS.analyzePath(R+"/PG_VERSION").exists?h(this,g,Fe).call(this,"pglite: found DB, resuming"):h(this,g,Fe).call(this,"pglite: no db"),await gi(this.mod,(...a)=>h(this,g,Fe).call(this,...a));let o=this.mod._pg_initdb();if(!o)throw new Error("INITDB failed to return value");if(o&1)throw new Error("INITDB failed");if(o&2){let a=e.username??"postgres",u=e.database??"template1";if(o&4){if(!(o&12))throw new Error("Invalid db/user combination")}else if(u!=="template1"&&a!=="postgres")throw new Error("INITDB created a new datadir, but an alternative db/user was requested")}await h(this,g,ht).call(this),await h(this,g,pe).call(this,"SET search_path TO public;"),x(this,Ge,!0);for(let a of n)await a()},Jr=async function(e,t,n){return await p(this,mt).runExclusive(async()=>{h(this,g,Fe).call(this,"runQuery",e,t,n),await h(this,g,Zr).call(this,n?.blob);let i=t?.map(a=>Gt(a,n?.setAllTypes))||[],s;try{s=[...await h(this,g,fe).call(this,z.parse({text:e,types:i.map(([,a])=>a)}),n),...await h(this,g,fe).call(this,z.bind({values:i.map(([a])=>a)}),n),...await h(this,g,fe).call(this,z.describe({type:"P"}),n),...await h(this,g,fe).call(this,z.execute({}),n)]}finally{await h(this,g,fe).call(this,z.sync(),n)}h(this,g,en).call(this),p(this,Te)||await h(this,g,ht).call(this);let o;return p(this,j)&&(o=new Blob(p(this,j)),x(this,j,void 0)),$t(s.map(([a])=>a),n,o)[0]})},pe=async function(e,t){return await p(this,mt).runExclusive(async()=>{h(this,g,Fe).call(this,"runExec",e,t),await h(this,g,Zr).call(this,t?.blob);let n;try{n=await h(this,g,fe).call(this,z.query(e),t)}finally{await h(this,g,fe).call(this,z.sync(),t)}h(this,g,en).call(this),p(this,Te)||await h(this,g,ht).call(this);let i;return p(this,j)&&(i=new Blob(p(this,j)),x(this,j,void 0)),$t(n.map(([s])=>s),t,i)})},Zr=async function(e){x(this,Ae,e?await e.arrayBuffer():void 0)},en=function(){x(this,Ae,void 0)},dt=async function(){if(p(this,Be))throw new Error("PGlite is closing");if(p(this,Ie))throw new Error("PGlite is closed");p(this,Ge)||await this.waitReady},fe=async function(e,t={}){return await this.execProtocol(e,{...t,syncToFs:!1})},ht=async function(){if(p(this,qe))return;x(this,qe,!0);let e=async()=>{await p(this,Qt).runExclusive(async()=>{x(this,qe,!1),await this.fs.syncToFs(this.mod.FS,p(this,He))})};p(this,He)?e():await e()},Fe=function(...e){this.debug>0&&console.log(...e)};var Xr=tn;m();ar();or();0&&(module.exports={IdbFs,MemoryFS,Mutex,PGlite,formatQuery,messages,parse,protocol,types,uuid});
/*! Bundled license information:

ieee754/index.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)

buffer/index.js:
  (*!
   * The buffer module from node.js, for the browser.
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)
*/
//# sourceMappingURL=index.cjs.map