"use strict";var xr=Object.create;var M=Object.defineProperty;var Tr=Object.getOwnPropertyDescriptor;var Sr=Object.getOwnPropertyNames;var hr=Object.getPrototypeOf,Ar=Object.prototype.hasOwnProperty;var T=(r,e)=>()=>(r&&(e=r(r=0)),e);var A=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),wr=(r,e)=>{for(var t in e)M(r,t,{get:e[t],enumerable:!0})},J=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Sr(e))!Ar.call(r,i)&&i!==t&&M(r,i,{get:()=>e[i],enumerable:!(n=Tr(e,i))||n.enumerable});return r};var b=(r,e,t)=>(t=r!=null?xr(hr(r)):{},J(e||!r||!r.__esModule?M(t,"default",{value:r,enumerable:!0}):t,r)),Pr=r=>J(M({},"__esModule",{value:!0}),r);var s=T(()=>{"use strict"});var w,C=T(()=>{"use strict";s();w=class{constructor(e){this.dataDir=e}async syncToFs(e,t){}async initialSyncFs(e){}async close(e){}}});var v=A((me,f)=>{"use strict";s();var Q=9007199254740991,V=function(r){return r}();function Ur(r){return r===V}function rr(r){return typeof r=="string"||Object.prototype.toString.call(r)=="[object String]"}function br(r){return Object.prototype.toString.call(r)=="[object Date]"}function I(r){return r!==null&&typeof r=="object"}function k(r){return typeof r=="function"}function vr(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=Q}function Er(r){return Object.prototype.toString.call(r)=="[object Array]"}function er(r){return I(r)&&!k(r)&&vr(r.length)}function B(r){return Object.prototype.toString.call(r)=="[object ArrayBuffer]"}function zr(r,e){return Array.prototype.map.call(r,e)}function Mr(r,e){var t=V;return k(e)&&Array.prototype.every.call(r,function(n,i,c){var a=e(n,i,c);return a&&(t=n),!a}),t}function Cr(r){return Object.assign.apply(null,arguments)}function tr(r){var e,t,n;if(rr(r)){for(t=r.length,n=new Uint8Array(t),e=0;e<t;e++)n[e]=r.charCodeAt(e)&255;return n}return B(r)?new Uint8Array(r):I(r)&&B(r.buffer)?new Uint8Array(r.buffer):er(r)?new Uint8Array(r):I(r)&&k(r.toString)?tr(r.toString()):new Uint8Array}f.exports.MAX_SAFE_INTEGER=Q;f.exports.isUndefined=Ur;f.exports.isString=rr;f.exports.isObject=I;f.exports.isDateTime=br;f.exports.isFunction=k;f.exports.isArray=Er;f.exports.isArrayLike=er;f.exports.isArrayBuffer=B;f.exports.map=zr;f.exports.find=Mr;f.exports.extend=Cr;f.exports.toUint8Array=tr});var E=A((de,nr)=>{"use strict";s();var q="\0";nr.exports={NULL_CHAR:q,TMAGIC:"ustar"+q+"00",OLDGNU_MAGIC:"ustar  "+q,REGTYPE:0,LNKTYPE:1,SYMTYPE:2,CHRTYPE:3,BLKTYPE:4,DIRTYPE:5,FIFOTYPE:6,CONTTYPE:7,TSUID:parseInt("4000",8),TSGID:parseInt("2000",8),TSVTX:parseInt("1000",8),TUREAD:parseInt("0400",8),TUWRITE:parseInt("0200",8),TUEXEC:parseInt("0100",8),TGREAD:parseInt("0040",8),TGWRITE:parseInt("0020",8),TGEXEC:parseInt("0010",8),TOREAD:parseInt("0004",8),TOWRITE:parseInt("0002",8),TOEXEC:parseInt("0001",8),TPERMALL:parseInt("0777",8),TPERMMASK:parseInt("0777",8)}});var X=A((ge,m)=>{"use strict";s();var ir=v(),p=E(),Ir=512,W=p.TPERMALL,or=0,sr=0,Y=[["name",100,0,function(r,e){return z(r[e[0]],e[1])},function(r,e,t){return S(r.slice(e,e+t[1]))}],["mode",8,100,function(r,e){var t=r[e[0]]||W;return t=t&p.TPERMMASK,P(t,e[1],W)},function(r,e,t){var n=g(r.slice(e,e+t[1]));return n&=p.TPERMMASK,n}],["uid",8,108,function(r,e){return P(r[e[0]],e[1],or)},function(r,e,t){return g(r.slice(e,e+t[1]))}],["gid",8,116,function(r,e){return P(r[e[0]],e[1],sr)},function(r,e,t){return g(r.slice(e,e+t[1]))}],["size",12,124,function(r,e){return P(r.data.length,e[1])},function(r,e,t){return g(r.slice(e,e+t[1]))}],["modifyTime",12,136,function(r,e){return D(r[e[0]],e[1])},function(r,e,t){return R(r.slice(e,e+t[1]))}],["checksum",8,148,function(r,e){return"        "},function(r,e,t){return g(r.slice(e,e+t[1]))}],["type",1,156,function(r,e){return""+(parseInt(r[e[0]],10)||0)%8},function(r,e,t){return(parseInt(String.fromCharCode(r[e]),10)||0)%8}],["linkName",100,157,function(r,e){return""},function(r,e,t){return S(r.slice(e,e+t[1]))}],["ustar",8,257,function(r,e){return p.TMAGIC},function(r,e,t){return kr(S(r.slice(e,e+t[1]),!0))},function(r,e){return r[e[0]]==p.TMAGIC||r[e[0]]==p.OLDGNU_MAGIC}],["owner",32,265,function(r,e){return z(r[e[0]],e[1])},function(r,e,t){return S(r.slice(e,e+t[1]))}],["group",32,297,function(r,e){return z(r[e[0]],e[1])},function(r,e,t){return S(r.slice(e,e+t[1]))}],["majorNumber",8,329,function(r,e){return""},function(r,e,t){return g(r.slice(e,e+t[1]))}],["minorNumber",8,337,function(r,e){return""},function(r,e,t){return g(r.slice(e,e+t[1]))}],["prefix",131,345,function(r,e){return z(r[e[0]],e[1])},function(r,e,t){return S(r.slice(e,e+t[1]))}],["accessTime",12,476,function(r,e){return D(r[e[0]],e[1])},function(r,e,t){return R(r.slice(e,e+t[1]))}],["createTime",12,488,function(r,e){return D(r[e[0]],e[1])},function(r,e,t){return R(r.slice(e,e+t[1]))}]],ar=function(r){var e=r[r.length-1];return e[2]+e[1]}(Y);function kr(r){if(r.length==8){var e=r.split("");if(e[5]==p.NULL_CHAR)return(e[6]==" "||e[6]==p.NULL_CHAR)&&(e[6]="0"),(e[7]==" "||e[7]==p.NULL_CHAR)&&(e[7]="0"),e=e.join(""),e==p.TMAGIC?e:r;if(e[7]==p.NULL_CHAR)return e[5]==p.NULL_CHAR&&(e[5]=" "),e[6]==p.NULL_CHAR&&(e[6]=" "),e==p.OLDGNU_MAGIC?e:r}return r}function z(r,e){return e-=1,ir.isUndefined(r)&&(r=""),r=(""+r).substr(0,e),r+p.NULL_CHAR}function P(r,e,t){for(t=parseInt(t)||0,e-=1,r=(parseInt(r)||t).toString(8).substr(-e,e);r.length<e;)r="0"+r;return r+p.NULL_CHAR}function D(r,e){if(ir.isDateTime(r))r=Math.floor(1*r/1e3);else if(r=parseInt(r,10),isFinite(r)){if(r<=0)return""}else r=Math.floor(1*new Date/1e3);return P(r,e,0)}function S(r,e){var t=String.fromCharCode.apply(null,r);if(e)return t;var n=t.indexOf(p.NULL_CHAR);return n>=0?t.substr(0,n):t}function g(r){var e=String.fromCharCode.apply(null,r);return parseInt(e.replace(/^0+$/g,""),8)||0}function R(r){return r.length==0||r[0]==0?null:new Date(1e3*g(r))}function Dr(r,e,t){var n=parseInt(e,10)||0,i=Math.min(n+ar,r.length),c=0,a=0,o=0;t&&Y.every(function(F){return F[0]=="checksum"?(a=n+F[2],o=a+F[1],!1):!0});for(var u=32,d=n;d<i;d++){var j=d>=a&&d<o?u:r[d];c=(c+j)%262144}return c}m.exports.recordSize=Ir;m.exports.defaultFileMode=W;m.exports.defaultUid=or;m.exports.defaultGid=sr;m.exports.posixHeader=Y;m.exports.effectiveHeaderSize=ar;m.exports.calculateChecksum=Dr;m.exports.formatTarString=z;m.exports.formatTarNumber=P;m.exports.formatTarDateTime=D;m.exports.parseTarString=S;m.exports.parseTarNumber=g;m.exports.parseTarDateTime=R});var fr=A((xe,pr)=>{"use strict";s();var Rr=E(),L=v(),x=X();function cr(r){return x.recordSize}function ur(r){return Math.ceil(r.data.length/x.recordSize)*x.recordSize}function Lr(r){var e=0;return r.forEach(function(t){e+=cr(t)+ur(t)}),e+=x.recordSize*2,new Uint8Array(e)}function Nr(r,e,t){t=parseInt(t)||0;var n=t;x.posixHeader.forEach(function(u){for(var d=u[3](e,u),j=d.length,F=0;F<j;F+=1)r[n+F]=d.charCodeAt(F)&255;n+=u[1]});var i=L.find(x.posixHeader,function(u){return u[0]=="checksum"});if(i){var c=x.calculateChecksum(r,t,!0),a=x.formatTarNumber(c,i[1]-2)+Rr.NULL_CHAR+" ";n=t+i[2];for(var o=0;o<a.length;o+=1)r[n]=a.charCodeAt(o)&255,n++}return t+cr(e)}function Or(r,e,t){return t=parseInt(t,10)||0,r.set(e.data,t),t+ur(e)}function _r(r){r=L.map(r,function(n){return L.extend({},n,{data:L.toUint8Array(n.data)})});var e=Lr(r),t=0;return r.forEach(function(n){t=Nr(e,n,t),t=Or(e,n,t)}),e}pr.exports.tar=_r});var lr=A((Se,mr)=>{"use strict";s();var Gr=E(),$=v(),y=X(),Hr={extractData:!0,checkHeader:!0,checkChecksum:!0,checkFileSize:!0},jr={size:!0,checksum:!0,ustar:!0},K={unexpectedEndOfFile:"Unexpected end of file.",fileCorrupted:"File is corrupted.",checksumCheckFailed:"Checksum check failed."};function Br(r){return y.recordSize}function qr(r){return Math.ceil(r/y.recordSize)*y.recordSize}function Wr(r,e){for(var t=e,n=Math.min(r.length,e+y.recordSize*2),i=t;i<n;i++)if(r[i]!=0)return!1;return!0}function Yr(r,e,t){if(r.length-e<y.recordSize){if(t.checkFileSize)throw new Error(K.unexpectedEndOfFile);return null}e=parseInt(e)||0;var n={},i=e;if(y.posixHeader.forEach(function(o){n[o[0]]=o[4](r,i,o),i+=o[1]}),n.type!=0&&(n.size=0),t.checkHeader&&y.posixHeader.forEach(function(o){if($.isFunction(o[5])&&!o[5](n,o)){var u=new Error(K.fileCorrupted);throw u.data={offset:e+o[2],field:o[0]},u}}),t.checkChecksum){var c=y.calculateChecksum(r,e,!0);if(c!=n.checksum){var a=new Error(K.checksumCheckFailed);throw a.data={offset:e,header:n,checksum:c},a}}return n}function Xr(r,e,t,n){return n.extractData?t.size<=0?new Uint8Array:r.slice(e,e+t.size):null}function Kr(r,e){var t={};return y.posixHeader.forEach(function(n){var i=n[0];jr[i]||(t[i]=r[i])}),t.isOldGNUFormat=r.ustar==Gr.OLDGNU_MAGIC,e&&(t.data=e),t}function $r(r,e){e=$.extend({},Hr,e);for(var t=[],n=0,i=r.length;i-n>=y.recordSize;){r=$.toUint8Array(r);var c=Yr(r,n,e);if(!c)break;n+=Br(c);var a=Xr(r,n,c,e);if(t.push(Kr(c,a)),n+=qr(c.size),Wr(r,n))break}return t}mr.exports.untar=$r});var yr=A((Ae,dr)=>{"use strict";s();var Zr=v(),Jr=E(),Qr=fr(),Vr=lr();Zr.extend(dr.exports,Qr,Vr,Jr)});async function N(r,e){let t=ee(r,U),[n,i]=await te(t),c=(e||"pgdata")+(i?".tar.gz":".tar"),a=i?"application/x-gzip":"application/x-tar";return typeof File<"u"?new File([n],c,{type:a}):new Blob([n],{type:a})}function re(r,e){let t=[],n=i=>{r.readdir(i).forEach(a=>{if(a==="."||a==="..")return;let o=i+"/"+a,u=r.stat(o),d=r.isFile(u.mode)?r.readFile(o,{encoding:"binary"}):new Uint8Array(0);t.push({name:o.substring(e.length),mode:u.mode,size:u.size,type:r.isFile(u.mode)?h.REGTYPE:h.DIRTYPE,modifyTime:u.mtime,data:d}),r.isDir(u.mode)&&n(o)})};return n(e),t}function ee(r,e){let t=re(r,e);return(0,h.tar)(t)}async function te(r){return typeof window<"u"&&"CompressionStream"in window?[await ne(r),!0]:typeof process<"u"&&process.versions&&process.versions.node?[await ie(r),!0]:[r,!1]}async function ne(r){let e=new CompressionStream("gzip"),t=e.writable.getWriter(),n=e.readable.getReader();t.write(r),t.close();let i=[];for(;;){let{value:o,done:u}=await n.read();if(u)break;o&&i.push(o)}let c=new Uint8Array(i.reduce((o,u)=>o+u.length,0)),a=0;return i.forEach(o=>{c.set(o,a),a+=o.length}),c}async function ie(r){let{promisify:e}=await import("util"),{gzip:t}=await import("zlib");return await e(t)(r)}var h,O=T(()=>{"use strict";s();h=b(yr(),1);_()});var gr=T(()=>{"use strict";s();C();_();O()});var Fr=T(()=>{"use strict";s();C();O()});var oe,U,_=T(()=>{"use strict";s();gr();Fr();oe="/tmp/pglite",U=oe+"/base"});var se={};wr(se,{NodeFS:()=>Z});module.exports=Pr(se);var G,H,Z,ae=T(()=>{s();G=b(require("fs"),1),H=b(require("path"),1);C();_();O();Z=class extends w{constructor(e){super(e),this.rootDir=H.resolve(e),G.existsSync(H.join(this.rootDir))||G.mkdirSync(this.rootDir)}async emscriptenOpts(e){return{...e,preRun:[...e.preRun||[],n=>{let i=n.FS.filesystems.NODEFS;n.FS.mkdir(U),n.FS.mount(i,{root:this.rootDir},U)}]}}async dumpTar(e,t){return N(e,t)}async close(e){e.quit()}}});ae();0&&(module.exports={NodeFS});
//# sourceMappingURL=nodefs.cjs.map